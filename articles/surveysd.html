<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to surveysd • surveysd</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Introduction to surveysd">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">surveysd</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.3.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/surveysd.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/error_estimation.html">Error estimation</a></li>
    <li><a class="dropdown-item" href="../articles/ipf.html">Iterative Proportional Fitting</a></li>
    <li><a class="dropdown-item" href="../articles/methodology.html">Methodology</a></li>
    <li><a class="dropdown-item" href="../articles/raowu.html">Rao-Wu Bootstrap in surveysd</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/statistikat/surveysd/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Introduction to surveysd</h1>
            
            <h4 data-toc-skip class="date">2025-08-21</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/statistikat/surveysd/blob/master/vignettes/surveysd.Rmd" class="external-link"><code>vignettes/surveysd.Rmd</code></a></small>
      <div class="d-none name"><code>surveysd.Rmd</code></div>
    </div>

    
    
<p>The goal of surveysd is to combine all necessary steps to use
calibrated bootstrapping with custom estimation functions. This vignette
will cover the usage of the most important functions. For insights in
the theory used in this package, refer to
<code><a href="../articles/methodology.html">vignette("methodology")</a></code>.</p>
<div class="section level3">
<h3 id="load-dummy-data">Load dummy data<a class="anchor" aria-label="anchor" href="#load-dummy-data"></a>
</h3>
<p>A test data set based on
<code>data(eusilc, package = "laeken")</code> can be created with
<code><a href="../reference/demo.eusilc.html">demo.eusilc()</a></code></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/statistikat/surveysd" class="external-link">surveysd</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">eusilc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/demo.eusilc.html">demo.eusilc</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">2</span>, prettyNames <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">eusilc</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fu">.</span><span class="op">(</span><span class="va">year</span>, <span class="va">povertyRisk</span>, <span class="va">gender</span>, <span class="va">pWeight</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##     year povertyRisk gender  pWeight</span></span>
<span><span class="co">##    &lt;num&gt;      &lt;lgcl&gt; &lt;fctr&gt;    &lt;num&gt;</span></span>
<span><span class="co">## 1:  2010       FALSE female 504.5696</span></span>
<span><span class="co">## 2:  2010       FALSE   male 504.5696</span></span>
<span><span class="co">## 3:  2010       FALSE   male 504.5696</span></span>
<span><span class="co">## 4:  2010       FALSE female 493.3824</span></span>
<span><span class="co">## 5:  2010       FALSE   male 493.3824</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="draw-bootstrap-replicates">Draw bootstrap replicates<a class="anchor" aria-label="anchor" href="#draw-bootstrap-replicates"></a>
</h3>
<p>Use stratified resampling without replacement to generate 10 samples.
Those samples are consistent with respect to the reference periods.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat_boot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/draw.bootstrap.html">draw.bootstrap</a></span><span class="op">(</span><span class="va">eusilc</span>, REP <span class="op">=</span> <span class="fl">10</span>, hid <span class="op">=</span> <span class="st">"hid"</span>, weights <span class="op">=</span> <span class="st">"pWeight"</span>, </span>
<span>                           strata <span class="op">=</span> <span class="st">"region"</span>, period <span class="op">=</span> <span class="st">"year"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="calibrate-bootstrap-replicates">Calibrate bootstrap replicates<a class="anchor" aria-label="anchor" href="#calibrate-bootstrap-replicates"></a>
</h3>
<p>Calibrate each sample according to the distribution of
<code>gender</code> (on a personal level) and <code>region</code> (on a
household level).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat_boot_calib</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/recalib.html">recalib</a></span><span class="op">(</span><span class="va">dat_boot</span>, conP.var <span class="op">=</span> <span class="st">"gender"</span>, conH.var <span class="op">=</span> <span class="st">"region"</span>,</span>
<span>                          epsP <span class="op">=</span> <span class="fl">1e-2</span>, epsH <span class="op">=</span> <span class="fl">2.5e-2</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">dat_boot_calib</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fu">.</span><span class="op">(</span><span class="va">year</span>, <span class="va">povertyRisk</span>, <span class="va">gender</span>, <span class="va">pWeight</span>, <span class="va">w1</span>, <span class="va">w2</span>, <span class="va">w3</span>, <span class="va">w4</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##     year povertyRisk gender  pWeight           w1          w2        w3</span></span>
<span><span class="co">##    &lt;num&gt;      &lt;lgcl&gt; &lt;fctr&gt;    &lt;num&gt;        &lt;num&gt;       &lt;num&gt;     &lt;num&gt;</span></span>
<span><span class="co">## 1:  2010       FALSE female 504.5696 1008.6905620   0.4520084 1019.0491</span></span>
<span><span class="co">## 2:  2010       FALSE   male 504.5696 1008.6905620   0.4520084 1019.0491</span></span>
<span><span class="co">## 3:  2010       FALSE   male 504.5696 1008.6905620   0.4520084 1019.0491</span></span>
<span><span class="co">## 4:  2010       FALSE female 493.3824    0.4387304 994.3680330  997.8997</span></span>
<span><span class="co">## 5:  2010       FALSE   male 493.3824    0.4387304 994.3680330  997.8997</span></span>
<span><span class="co">##          w4</span></span>
<span><span class="co">##       &lt;num&gt;</span></span>
<span><span class="co">## 1: 1008.691</span></span>
<span><span class="co">## 2: 1008.691</span></span>
<span><span class="co">## 3: 1008.691</span></span>
<span><span class="co">## 4:  986.326</span></span>
<span><span class="co">## 5:  986.326</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="estimate-with-respect-to-a-grouping-variable">Estimate with respect to a grouping variable<a class="anchor" aria-label="anchor" href="#estimate-with-respect-to-a-grouping-variable"></a>
</h3>
<p>Estimate relative amount of persons at risk of poverty per period and
<code>gender</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">err.est</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc.stError.html">calc.stError</a></span><span class="op">(</span><span class="va">dat_boot_calib</span>, var <span class="op">=</span> <span class="st">"povertyRisk"</span>, fun <span class="op">=</span> <span class="va">weightedRatio</span>, group <span class="op">=</span> <span class="st">"gender"</span><span class="op">)</span></span>
<span><span class="va">err.est</span><span class="op">$</span><span class="va">Estimates</span></span></code></pre></div>
<pre><code><span><span class="co">## Key: &lt;year, n, N, gender, estimate_type&gt;</span></span>
<span><span class="co">##     year     n       N gender estimate_type val_povertyRisk stE_povertyRisk</span></span>
<span><span class="co">##    &lt;num&gt; &lt;int&gt;   &lt;num&gt; &lt;fctr&gt;        &lt;char&gt;           &lt;num&gt;           &lt;num&gt;</span></span>
<span><span class="co">## 1:  2010  7267 3979572   male        direct        12.02660       0.3502150</span></span>
<span><span class="co">## 2:  2010  7560 4202650 female        direct        16.73351       0.5207185</span></span>
<span><span class="co">## 3:  2010 14827 8182222   &lt;NA&gt;        direct        14.44422       0.4205727</span></span>
<span><span class="co">## 4:  2011  7267 3979572   male        direct        12.81921       0.5846756</span></span>
<span><span class="co">## 5:  2011  7560 4202650 female        direct        16.62488       0.6858789</span></span>
<span><span class="co">## 6:  2011 14827 8182222   &lt;NA&gt;        direct        14.77393       0.6137248</span></span></code></pre>
<p>The output contains estimates (<code>val_povertyRisk</code>) as well
as standard errors (<code>stE_povertyRisk</code>) measured in percent.
The rows with <code>gender = NA</code> denotes the aggregate over all
genders for the corresponding year.</p>
</div>
<div class="section level3">
<h3 id="estimate-with-respect-to-several-variables">Estimate with respect to several variables<a class="anchor" aria-label="anchor" href="#estimate-with-respect-to-several-variables"></a>
</h3>
<p>Estimate relative amount of persons at risk of poverty per period for
each <code>region</code>, <code>gender</code>, and combination of
both.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"gender"</span>, <span class="st">"region"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gender"</span>, <span class="st">"region"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">err.est</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc.stError.html">calc.stError</a></span><span class="op">(</span><span class="va">dat_boot_calib</span>, var <span class="op">=</span> <span class="st">"povertyRisk"</span>, fun <span class="op">=</span> <span class="va">weightedRatio</span>, group <span class="op">=</span> <span class="va">group</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">err.est</span><span class="op">$</span><span class="va">Estimates</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Key: &lt;year, n, N, gender, region, estimate_type&gt;</span></span>
<span><span class="co">##     year     n        N gender     region estimate_type val_povertyRisk</span></span>
<span><span class="co">##    &lt;num&gt; &lt;int&gt;    &lt;num&gt; &lt;fctr&gt;     &lt;fctr&gt;        &lt;char&gt;           &lt;num&gt;</span></span>
<span><span class="co">## 1:  2010   261 122741.8   male Burgenland        direct       17.414524</span></span>
<span><span class="co">## 2:  2010   288 137822.2 female Burgenland        direct       21.432598</span></span>
<span><span class="co">## 3:  2010   359 182732.9   male Vorarlberg        direct       12.973259</span></span>
<span><span class="co">## 4:  2010   374 194622.1 female Vorarlberg        direct       19.883637</span></span>
<span><span class="co">## 5:  2010   440 253143.7   male   Salzburg        direct        9.156964</span></span>
<span><span class="co">## 6:  2010   484 282307.3 female   Salzburg        direct       17.939382</span></span>
<span><span class="co">##    stE_povertyRisk</span></span>
<span><span class="co">##              &lt;num&gt;</span></span>
<span><span class="co">## 1:        3.705433</span></span>
<span><span class="co">## 2:        2.839979</span></span>
<span><span class="co">## 3:        2.732549</span></span>
<span><span class="co">## 4:        2.854023</span></span>
<span><span class="co">## 5:        2.047969</span></span>
<span><span class="co">## 6:        2.841408</span></span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## skipping 54 more rows</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Johannes Gussenbauer, Alexander Kowarik, Eileen Vattheuer, Gregor de Cillia.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
