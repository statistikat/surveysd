<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Error estimation • surveysd</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Error estimation">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">surveysd</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.3.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/surveysd.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/error_estimation.html">Error estimation</a></li>
    <li><a class="dropdown-item" href="../articles/ipf.html">Iterative Proportional Fitting</a></li>
    <li><a class="dropdown-item" href="../articles/methodology.html">Methodology</a></li>
    <li><a class="dropdown-item" href="../articles/raowu.html">Rao-Wu Bootstrap in surveysd</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/statistikat/surveysd/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Error estimation</h1>
            
            <h4 data-toc-skip class="date">2025-08-21</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/statistikat/surveysd/blob/master/vignettes/error_estimation.Rmd" class="external-link"><code>vignettes/error_estimation.Rmd</code></a></small>
      <div class="d-none name"><code>error_estimation.Rmd</code></div>
    </div>

    
    
<p>For the most part, this document will present the functionalities of
the function <code><a href="../reference/calc.stError.html">surveysd::calc.stError()</a></code> which generates point
estimates and standard errors for user-supplied estimation
functions.</p>
<div class="section level2">
<h2 id="prerequisites">Prerequisites<a class="anchor" aria-label="anchor" href="#prerequisites"></a>
</h2>
<p>In order to use a dataset with <code><a href="../reference/calc.stError.html">calc.stError()</a></code>, several
weight columns have to be present. Each weight column corresponds to a
bootstrap sample. In the following examples, we will use the data from
<code><a href="../reference/demo.eusilc.html">demo.eusilc()</a></code> and attach the bootstrap weights using
<code><a href="../reference/draw.bootstrap.html">draw.bootstrap()</a></code> and <code><a href="../reference/recalib.html">recalib()</a></code>. Please refer
to the documentation of those functions for more detail.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/statistikat/surveysd" class="external-link">surveysd</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">eusilc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/demo.eusilc.html">demo.eusilc</a></span><span class="op">(</span>prettyNames <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">dat_boot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/draw.bootstrap.html">draw.bootstrap</a></span><span class="op">(</span><span class="va">eusilc</span>, REP <span class="op">=</span> <span class="fl">10</span>, hid <span class="op">=</span> <span class="st">"hid"</span>, weights <span class="op">=</span> <span class="st">"pWeight"</span>,</span>
<span>                           strata <span class="op">=</span> <span class="st">"region"</span>, period <span class="op">=</span> <span class="st">"year"</span><span class="op">)</span></span>
<span><span class="va">dat_boot_calib</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/recalib.html">recalib</a></span><span class="op">(</span><span class="va">dat_boot</span>, conP.var <span class="op">=</span> <span class="st">"gender"</span>, conH.var <span class="op">=</span> <span class="st">"region"</span>,</span>
<span>                          epsP <span class="op">=</span> <span class="fl">1e-2</span>, epsH <span class="op">=</span> <span class="fl">2.5e-2</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in ipf(dat = copy(dat[, mget(c(g, select.var))]), conP = conP, conH =</span></span>
<span><span class="co">## conH, : Not converged in 200 steps</span></span></code></pre>
<pre><code><span><span class="co">## Calibration failed for bootstrap replicates w3 </span></span>
<span><span class="co">## Corresponding bootstrap replicates will be discarded</span></span>
<span><span class="co">## Returning 9 calibrated bootstrap weights</span></span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat_boot_calib</span><span class="op">[</span>, <span class="va">onePerson</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">.SD</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span>, by <span class="op">=</span> <span class="fu">.</span><span class="op">(</span><span class="va">year</span>, <span class="va">hid</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co">## print part of the dataset</span></span>
<span><span class="va">dat_boot_calib</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fu">.</span><span class="op">(</span><span class="va">year</span>, <span class="va">povertyRisk</span>, <span class="va">eqIncome</span>, <span class="va">onePerson</span>, <span class="va">pWeight</span>, <span class="va">w1</span>, <span class="va">w2</span>, <span class="va">w3</span>, <span class="va">w4</span>, <span class="va">w5</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##     year povertyRisk eqIncome onePerson  pWeight          w1       w2</span></span>
<span><span class="co">##    &lt;num&gt;      &lt;lgcl&gt;    &lt;num&gt;    &lt;lgcl&gt;    &lt;num&gt;       &lt;num&gt;    &lt;num&gt;</span></span>
<span><span class="co">## 1:  2010       FALSE 16090.69     FALSE 504.5696   0.4474822 1025.910</span></span>
<span><span class="co">## 2:  2010       FALSE 16090.69     FALSE 504.5696   0.4474822 1025.910</span></span>
<span><span class="co">## 3:  2010       FALSE 16090.69     FALSE 504.5696   0.4474822 1025.910</span></span>
<span><span class="co">## 4:  2010       FALSE 27076.24     FALSE 493.3824 983.8905845 1002.231</span></span>
<span><span class="co">## 5:  2010       FALSE 27076.24     FALSE 493.3824 983.8905845 1002.231</span></span>
<span><span class="co">##             w3          w4           w5</span></span>
<span><span class="co">##          &lt;num&gt;       &lt;num&gt;        &lt;num&gt;</span></span>
<span><span class="co">## 1:   0.4450813 995.7771076 1006.3937959</span></span>
<span><span class="co">## 2:   0.4450813 995.7771076 1006.3937959</span></span>
<span><span class="co">## 3:   0.4450813 995.7771076 1006.3937959</span></span>
<span><span class="co">## 4: 977.3074985   0.4330742    0.4378805</span></span>
<span><span class="co">## 5: 977.3074985   0.4330742    0.4378805</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="estimator-functions">Estimator functions<a class="anchor" aria-label="anchor" href="#estimator-functions"></a>
</h2>
<p>The parameters <code>fun</code> and <code>var</code> in
<code><a href="../reference/calc.stError.html">calc.stError()</a></code> define the estimator to be used in the error
analysis. There are two built-in estimator functions
<code><a href="../reference/PointEstimates.html">weightedSum()</a></code> and <code><a href="../reference/PointEstimates.html">weightedRatio()</a></code> which can be
used as follows.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">povertyRate</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc.stError.html">calc.stError</a></span><span class="op">(</span><span class="va">dat_boot_calib</span>, var <span class="op">=</span> <span class="st">"povertyRisk"</span>, fun <span class="op">=</span> <span class="va">weightedRatio</span><span class="op">)</span></span>
<span><span class="va">totalIncome</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc.stError.html">calc.stError</a></span><span class="op">(</span><span class="va">dat_boot_calib</span>, var <span class="op">=</span> <span class="st">"eqIncome"</span>, fun <span class="op">=</span> <span class="va">weightedSum</span><span class="op">)</span></span></code></pre></div>
<p>Those functions calculate the ratio of persons at risk of poverty (in
percent) and the total income. By default, the results are calculated
separately for each reference period.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">povertyRate</span><span class="op">$</span><span class="va">Estimates</span></span></code></pre></div>
<pre><code><span><span class="co">## Key: &lt;year, n, N, estimate_type&gt;</span></span>
<span><span class="co">##     year     n       N estimate_type val_povertyRisk stE_povertyRisk</span></span>
<span><span class="co">##    &lt;num&gt; &lt;int&gt;   &lt;num&gt;        &lt;char&gt;           &lt;num&gt;           &lt;num&gt;</span></span>
<span><span class="co">## 1:  2010 14827 8182222        direct        14.44422       0.5270691</span></span>
<span><span class="co">## 2:  2011 14827 8182222        direct        14.77393       0.3874091</span></span>
<span><span class="co">## 3:  2012 14827 8182222        direct        15.04515       0.4766350</span></span>
<span><span class="co">## 4:  2013 14827 8182222        direct        14.89013       0.5530805</span></span>
<span><span class="co">## 5:  2014 14827 8182222        direct        15.14556       0.4480311</span></span>
<span><span class="co">## 6:  2015 14827 8182222        direct        15.53640       0.4478586</span></span>
<span><span class="co">## 7:  2016 14827 8182222        direct        15.08315       0.4738048</span></span>
<span><span class="co">## 8:  2017 14827 8182222        direct        15.42019       0.5273047</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">totalIncome</span><span class="op">$</span><span class="va">Estimates</span></span></code></pre></div>
<pre><code><span><span class="co">## Key: &lt;year, n, N, estimate_type&gt;</span></span>
<span><span class="co">##     year     n       N estimate_type val_eqIncome stE_eqIncome</span></span>
<span><span class="co">##    &lt;num&gt; &lt;int&gt;   &lt;num&gt;        &lt;char&gt;        &lt;num&gt;        &lt;num&gt;</span></span>
<span><span class="co">## 1:  2010 14827 8182222        direct 162750998071    997696068</span></span>
<span><span class="co">## 2:  2011 14827 8182222        direct 161926931417    646597840</span></span>
<span><span class="co">## 3:  2012 14827 8182222        direct 162576509628    847862472</span></span>
<span><span class="co">## 4:  2013 14827 8182222        direct 163199507862   1166368307</span></span>
<span><span class="co">## 5:  2014 14827 8182222        direct 163986275009    834100158</span></span>
<span><span class="co">## 6:  2015 14827 8182222        direct 163416275447   1143590484</span></span>
<span><span class="co">## 7:  2016 14827 8182222        direct 162706205137    738731722</span></span>
<span><span class="co">## 8:  2017 14827 8182222        direct 164314959107   1215298596</span></span></code></pre>
<p>Columns that use the <code>val_</code> prefix denote the point
estimate belonging to the “main weight” of the dataset, which is
<code>pWeight</code> in case of the dataset used here.</p>
<p>Columns with the <code>stE_</code> prefix denote standard errors
calculated with bootstrap replicates. The replicates result in using
<code>w1</code>, <code>w2</code>, …, <code>w10</code> instead of
<code>pWeight</code> when applying the estimator.</p>
<p><code>n</code> denotes the number of observations for the year and
<code>N</code> denotes the total weight of those persons.</p>
<div class="section level3">
<h3 id="custom-estimators">Custom estimators<a class="anchor" aria-label="anchor" href="#custom-estimators"></a>
</h3>
<p>In order to define a custom estimator function to be used in
<code>fun</code>, the function needs to have at least two arguments like
the example below.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## define custom estimator</span></span>
<span><span class="va">myWeightedSum</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">w</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">*</span><span class="va">w</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">## check if results are equal to the one using `surveysd::weightedSum()`</span></span>
<span><span class="va">totalIncome2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc.stError.html">calc.stError</a></span><span class="op">(</span><span class="va">dat_boot_calib</span>, var <span class="op">=</span> <span class="st">"eqIncome"</span>, fun <span class="op">=</span> <span class="va">myWeightedSum</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">totalIncome</span><span class="op">$</span><span class="va">Estimates</span>, <span class="va">totalIncome2</span><span class="op">$</span><span class="va">Estimates</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<p>The parameters <code>x</code> and <code>w</code> can be assumed to be
vectors with equal length with <code>w</code> being numeric weight
vector and <code>x</code> being the column defined in the
<code>var</code> argument. It will be called once for each period (in
this case <code>year</code>) and for each weight column (in this case
<code>pWeight</code>, <code>w1</code>, <code>w2</code>, …,
<code>w10</code>).</p>
<p>Custom estimators using additional parameters can also be supplied
and parameter <code>add.arg</code> can be used to set the additional
arguments for the custom estimator.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## use add.arg-argument</span></span>
<span><span class="va">fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">w</span>, <span class="va">b</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">*</span><span class="va">w</span><span class="op">*</span><span class="va">b</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">add.arg</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>b<span class="op">=</span><span class="st">"onePerson"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">err.est</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc.stError.html">calc.stError</a></span><span class="op">(</span><span class="va">dat_boot_calib</span>, var <span class="op">=</span> <span class="st">"povertyRisk"</span>, fun <span class="op">=</span> <span class="va">fun</span>,</span>
<span>                        period.mean <span class="op">=</span> <span class="fl">0</span>, add.arg<span class="op">=</span><span class="va">add.arg</span><span class="op">)</span></span>
<span><span class="va">err.est</span><span class="op">$</span><span class="va">Estimates</span></span></code></pre></div>
<pre><code><span><span class="co">## Key: &lt;year, n, N, estimate_type&gt;</span></span>
<span><span class="co">##     year     n       N estimate_type val_povertyRisk stE_povertyRisk</span></span>
<span><span class="co">##    &lt;num&gt; &lt;int&gt;   &lt;num&gt;        &lt;char&gt;           &lt;num&gt;           &lt;num&gt;</span></span>
<span><span class="co">## 1:  2010 14827 8182222        direct        273683.9        13701.61</span></span>
<span><span class="co">## 2:  2011 14827 8182222        direct        261883.6        15932.74</span></span>
<span><span class="co">## 3:  2012 14827 8182222        direct        243083.9        15315.01</span></span>
<span><span class="co">## 4:  2013 14827 8182222        direct        238004.4        15673.86</span></span>
<span><span class="co">## 5:  2014 14827 8182222        direct        218572.1        10579.04</span></span>
<span><span class="co">## 6:  2015 14827 8182222        direct        219984.1        12958.38</span></span>
<span><span class="co">## 7:  2016 14827 8182222        direct        201753.9        12867.73</span></span>
<span><span class="co">## 8:  2017 14827 8182222        direct        196881.2        12189.36</span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># compare with direct computation</span></span>
<span><span class="va">compare.value</span> <span class="op">&lt;-</span> <span class="va">dat_boot_calib</span><span class="op">[</span>,<span class="fu">fun</span><span class="op">(</span><span class="va">povertyRisk</span>,<span class="va">pWeight</span>,b<span class="op">=</span><span class="va">onePerson</span><span class="op">)</span>,</span>
<span>                                 by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"year"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="op">(</span><span class="va">compare.value</span><span class="op">$</span><span class="va">V1</span><span class="op">-</span><span class="va">err.est</span><span class="op">$</span><span class="va">Estimates</span><span class="op">$</span><span class="va">val_povertyRisk</span><span class="op">)</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<p>The above chunk computes the weighted poverty ratio for single person
households.</p>
</div>
<div class="section level3">
<h3 id="adjust-variable-depending-on-bootstrap-weights">Adjust variable depending on bootstrap weights<a class="anchor" aria-label="anchor" href="#adjust-variable-depending-on-bootstrap-weights"></a>
</h3>
<p>In our example the variable <code>povertyRisk</code> is a boolean and
is <code>TRUE</code> if the income is less than 60% of the weighted
median income. Thus it directly depends on the original weight vector
<code>pWeight</code>. To further reduce the estimated error one should
calculate for each bootstrap replicate weight
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>w</mi><annotation encoding="application/x-tex">w</annotation></semantics></math>
the weighted median income
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>e</mi><mi>d</mi><mi>I</mi><mi>n</mi><mi>c</mi><mi>o</mi><mi>m</mi><msub><mi>e</mi><mi>w</mi></msub></mrow><annotation encoding="application/x-tex">medIncome_{w}</annotation></semantics></math>
and then define
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>o</mi><mi>v</mi><mi>e</mi><mi>r</mi><mi>t</mi><mi>y</mi><mi>R</mi><mi>i</mi><mi>s</mi><msub><mi>k</mi><mi>w</mi></msub></mrow><annotation encoding="application/x-tex">povertyRisk_w</annotation></semantics></math>
as</p>
<p><span class="math display">$$
povertyRisk_w = \cases{1 \quad\text{if Income}&lt;0.6\cdot
medIncome_{w}\\
                     0 \quad\text{else}}
$$</span></p>
<p>The estimator can then be applied to the new variable
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>o</mi><mi>v</mi><mi>e</mi><mi>r</mi><mi>t</mi><mi>y</mi><mi>R</mi><mi>i</mi><mi>s</mi><msub><mi>k</mi><mi>w</mi></msub></mrow><annotation encoding="application/x-tex">povertyRisk_w</annotation></semantics></math>.
This can be realized using a custom estimator function.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># custom estimator to first derive poverty threshold </span></span>
<span><span class="co"># and then estimate a weighted ratio</span></span>
<span><span class="va">povmd</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">w</span><span class="op">)</span> <span class="op">{</span></span>
<span> <span class="va">md</span> <span class="op">&lt;-</span> <span class="fu">laeken</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/laeken/man/weightedMedian.html" class="external-link">weightedMedian</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">w</span><span class="op">)</span><span class="op">*</span><span class="fl">0.6</span></span>
<span> <span class="va">pmd60</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">&lt;</span> <span class="va">md</span></span>
<span> <span class="co"># weighted ratio is directly estimated inside the function</span></span>
<span> <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">w</span><span class="op">[</span><span class="va">pmd60</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span><span class="op">*</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">err.est</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc.stError.html">calc.stError</a></span><span class="op">(</span></span>
<span>  <span class="va">dat_boot_calib</span>, var <span class="op">=</span> <span class="st">"povertyRisk"</span>, fun <span class="op">=</span> <span class="va">weightedRatio</span>,</span>
<span>  fun.adjust.var <span class="op">=</span> <span class="va">povmd</span>, adjust.var <span class="op">=</span> <span class="st">"eqIncome"</span><span class="op">)</span></span>
<span><span class="va">err.est</span><span class="op">$</span><span class="va">Estimates</span></span></code></pre></div>
<pre><code><span><span class="co">## Key: &lt;year, n, N, estimate_type&gt;</span></span>
<span><span class="co">##     year     n       N estimate_type val_povertyRisk stE_povertyRisk</span></span>
<span><span class="co">##    &lt;num&gt; &lt;int&gt;   &lt;num&gt;        &lt;char&gt;           &lt;num&gt;           &lt;num&gt;</span></span>
<span><span class="co">## 1:  2010 14827 8182222        direct        14.44422               0</span></span>
<span><span class="co">## 2:  2011 14827 8182222        direct        14.77393               0</span></span>
<span><span class="co">## 3:  2012 14827 8182222        direct        15.04515               0</span></span>
<span><span class="co">## 4:  2013 14827 8182222        direct        14.89013               0</span></span>
<span><span class="co">## 5:  2014 14827 8182222        direct        15.14556               0</span></span>
<span><span class="co">## 6:  2015 14827 8182222        direct        15.53640               0</span></span>
<span><span class="co">## 7:  2016 14827 8182222        direct        15.08315               0</span></span>
<span><span class="co">## 8:  2017 14827 8182222        direct        15.42019               0</span></span></code></pre>
<p>The approach shown above is only valid if no grouping variables are
supplied (parameter <code>group = NULL</code>). If grouping variables
are supplied one should use parameters <code>fun.adjust.var</code> and
<code>adjust.var</code> such that the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>o</mi><mi>v</mi><mi>e</mi><mi>r</mi><mi>t</mi><mi>y</mi><mi>R</mi><mi>i</mi><mi>s</mi><msub><mi>k</mi><mi>w</mi></msub></mrow><annotation encoding="application/x-tex">povertyRisk_w</annotation></semantics></math>
is first calculated for each <code>period</code> and then used for each
grouping in <code>group</code>.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># using fun.adjust.var and adjust.var to estimate povmd60 indicator</span></span>
<span><span class="co"># for each period and bootstrap weight before applying the weightedRatio</span></span>
<span><span class="va">povmd2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">w</span><span class="op">)</span> <span class="op">{</span></span>
<span> <span class="va">md</span> <span class="op">&lt;-</span> <span class="fu">laeken</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/laeken/man/weightedMedian.html" class="external-link">weightedMedian</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">w</span><span class="op">)</span><span class="op">*</span><span class="fl">0.6</span></span>
<span> <span class="va">pmd60</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">&lt;</span> <span class="va">md</span></span>
<span> <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">pmd60</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># set adjust.var="eqIncome" so the income vector is used to estimate</span></span>
<span><span class="co"># the povmd60 indicator for each bootstrap weight</span></span>
<span><span class="co"># and the resulting indicators are passed to function weightedRatio</span></span>
<span><span class="va">group</span> <span class="op">&lt;-</span> <span class="st">"gender"</span></span>
<span><span class="va">err.est</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc.stError.html">calc.stError</a></span><span class="op">(</span></span>
<span>  <span class="va">dat_boot_calib</span>, var <span class="op">=</span> <span class="st">"povertyRisk"</span>, fun <span class="op">=</span> <span class="va">weightedRatio</span>, group <span class="op">=</span> <span class="st">"gender"</span>,</span>
<span>  fun.adjust.var <span class="op">=</span> <span class="va">povmd2</span>, adjust.var <span class="op">=</span> <span class="st">"eqIncome"</span><span class="op">)</span></span>
<span><span class="va">err.est</span><span class="op">$</span><span class="va">Estimates</span></span></code></pre></div>
<pre><code><span><span class="co">## Key: &lt;year, n, N, gender, estimate_type&gt;</span></span>
<span><span class="co">##      year     n       N gender estimate_type val_povertyRisk stE_povertyRisk</span></span>
<span><span class="co">##     &lt;num&gt; &lt;int&gt;   &lt;num&gt; &lt;fctr&gt;        &lt;char&gt;           &lt;num&gt;           &lt;num&gt;</span></span>
<span><span class="co">##  1:  2010  7267 3979572   male        direct        12.02660       0.4847427</span></span>
<span><span class="co">##  2:  2010  7560 4202650 female        direct        16.73351       0.3942573</span></span>
<span><span class="co">##  3:  2010 14827 8182222   &lt;NA&gt;        direct        14.44422       0.3831507</span></span>
<span><span class="co">##  4:  2011  7267 3979572   male        direct        12.81921       0.3187155</span></span>
<span><span class="co">##  5:  2011  7560 4202650 female        direct        16.62488       0.3738723</span></span>
<span><span class="co">##  6:  2011 14827 8182222   &lt;NA&gt;        direct        14.77393       0.3223062</span></span>
<span><span class="co">##  7:  2012  7267 3979572   male        direct        13.76065       0.2859919</span></span>
<span><span class="co">##  8:  2012  7560 4202650 female        direct        16.26147       0.5679499</span></span>
<span><span class="co">##  9:  2012 14827 8182222   &lt;NA&gt;        direct        15.04515       0.3738454</span></span>
<span><span class="co">## 10:  2013  7267 3979572   male        direct        13.88962       0.4774437</span></span>
<span><span class="co">## 11:  2013  7560 4202650 female        direct        15.83754       0.6443811</span></span>
<span><span class="co">## 12:  2013 14827 8182222   &lt;NA&gt;        direct        14.89013       0.4842724</span></span>
<span><span class="co">## 13:  2014  7267 3979572   male        direct        14.50351       0.6853320</span></span>
<span><span class="co">## 14:  2014  7560 4202650 female        direct        15.75353       0.6146861</span></span>
<span><span class="co">## 15:  2014 14827 8182222   &lt;NA&gt;        direct        15.14556       0.5642172</span></span>
<span><span class="co">## 16:  2015  7267 3979572   male        direct        15.12289       0.5878841</span></span>
<span><span class="co">## 17:  2015  7560 4202650 female        direct        15.92796       0.4336972</span></span>
<span><span class="co">## 18:  2015 14827 8182222   &lt;NA&gt;        direct        15.53640       0.4447793</span></span>
<span><span class="co">## 19:  2016  7267 3979572   male        direct        14.57968       0.5670821</span></span>
<span><span class="co">## 20:  2016  7560 4202650 female        direct        15.55989       0.4526653</span></span>
<span><span class="co">## 21:  2016 14827 8182222   &lt;NA&gt;        direct        15.08315       0.4651711</span></span>
<span><span class="co">## 22:  2017  7267 3979572   male        direct        14.94816       0.6280384</span></span>
<span><span class="co">## 23:  2017  7560 4202650 female        direct        15.86717       0.4630222</span></span>
<span><span class="co">## 24:  2017 14827 8182222   &lt;NA&gt;        direct        15.42019       0.4778929</span></span>
<span><span class="co">##      year     n       N gender estimate_type val_povertyRisk stE_povertyRisk</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="multiple-estimators">Multiple estimators<a class="anchor" aria-label="anchor" href="#multiple-estimators"></a>
</h3>
<p>In case an estimator should be applied to several columns of the
dataset, <code>var</code> can be set to a vector containing all
necessary columns.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">multipleRates</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc.stError.html">calc.stError</a></span><span class="op">(</span><span class="va">dat_boot_calib</span>, var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"povertyRisk"</span>, <span class="st">"onePerson"</span><span class="op">)</span>, fun <span class="op">=</span> <span class="va">weightedRatio</span><span class="op">)</span></span>
<span><span class="va">multipleRates</span><span class="op">$</span><span class="va">Estimates</span></span></code></pre></div>
<pre><code><span><span class="co">## Key: &lt;year, n, N, estimate_type&gt;</span></span>
<span><span class="co">##     year     n       N estimate_type val_povertyRisk stE_povertyRisk</span></span>
<span><span class="co">##    &lt;num&gt; &lt;int&gt;   &lt;num&gt;        &lt;char&gt;           &lt;num&gt;           &lt;num&gt;</span></span>
<span><span class="co">## 1:  2010 14827 8182222        direct        14.44422       0.4486606</span></span>
<span><span class="co">## 2:  2011 14827 8182222        direct        14.77393       0.3936171</span></span>
<span><span class="co">## 3:  2012 14827 8182222        direct        15.04515       0.4783872</span></span>
<span><span class="co">## 4:  2013 14827 8182222        direct        14.89013       0.4780918</span></span>
<span><span class="co">## 5:  2014 14827 8182222        direct        15.14556       0.5589814</span></span>
<span><span class="co">## 6:  2015 14827 8182222        direct        15.53640       0.4843245</span></span>
<span><span class="co">## 7:  2016 14827 8182222        direct        15.08315       0.3827949</span></span>
<span><span class="co">## 8:  2017 14827 8182222        direct        15.42019       0.5234875</span></span>
<span><span class="co">##    val_onePerson stE_onePerson</span></span>
<span><span class="co">##            &lt;num&gt;         &lt;num&gt;</span></span>
<span><span class="co">## 1:      14.85737     0.4486606</span></span>
<span><span class="co">## 2:      14.85737     0.3936171</span></span>
<span><span class="co">## 3:      14.85737     0.4783872</span></span>
<span><span class="co">## 4:      14.85737     0.4780918</span></span>
<span><span class="co">## 5:      14.85737     0.5589814</span></span>
<span><span class="co">## 6:      14.85737     0.4843245</span></span>
<span><span class="co">## 7:      14.85737     0.3827949</span></span>
<span><span class="co">## 8:      14.85737     0.5234875</span></span></code></pre>
<p>Here we see the relative number of persons at risk of poverty and the
relative number of one-person households.</p>
</div>
</div>
<div class="section level2">
<h2 id="grouping">Grouping<a class="anchor" aria-label="anchor" href="#grouping"></a>
</h2>
<p>The <code>groups</code> argument can be used to calculate estimators
for different subsets of the data. This argument can take the grouping
variable as a string that refers to a column name (usually a factor) in
<code>dat</code>. If set, all estimators are not only split by the
reference period but also by the grouping variable. For simplicity, only
one reference period of the above data is used.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">dat_boot_calib</span>, <span class="va">year</span> <span class="op">==</span> <span class="fl">2010</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">att</span>  <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"period"</span>, <span class="st">"weights"</span>, <span class="st">"b.rep"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">dat2</span>, <span class="va">att</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">dat_boot_calib</span>, <span class="va">att</span><span class="op">)</span></span></code></pre></div>
<p>To calculate the ratio of persons at risk of poverty for each federal
state of Austria, <code>group = "region"</code> can be used.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">povertyRates</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc.stError.html">calc.stError</a></span><span class="op">(</span><span class="va">dat2</span>, var <span class="op">=</span> <span class="st">"povertyRisk"</span>, fun <span class="op">=</span> <span class="va">weightedRatio</span>, group <span class="op">=</span> <span class="st">"region"</span><span class="op">)</span></span>
<span><span class="va">povertyRates</span><span class="op">$</span><span class="va">Estimates</span></span></code></pre></div>
<pre><code><span><span class="co">## Key: &lt;year, n, N, region, estimate_type&gt;</span></span>
<span><span class="co">##      year     n       N        region estimate_type val_povertyRisk</span></span>
<span><span class="co">##     &lt;num&gt; &lt;int&gt;   &lt;num&gt;        &lt;fctr&gt;        &lt;char&gt;           &lt;num&gt;</span></span>
<span><span class="co">##  1:  2010   549  260564    Burgenland        direct        19.53984</span></span>
<span><span class="co">##  2:  2010   733  377355    Vorarlberg        direct        16.53731</span></span>
<span><span class="co">##  3:  2010   924  535451      Salzburg        direct        13.78734</span></span>
<span><span class="co">##  4:  2010  1078  563648     Carinthia        direct        13.08627</span></span>
<span><span class="co">##  5:  2010  1317  701899         Tyrol        direct        15.30819</span></span>
<span><span class="co">##  6:  2010  2295 1167045        Styria        direct        14.37464</span></span>
<span><span class="co">##  7:  2010  2322 1598931        Vienna        direct        17.23468</span></span>
<span><span class="co">##  8:  2010  2804 1555709 Lower Austria        direct        13.84362</span></span>
<span><span class="co">##  9:  2010  2805 1421620 Upper Austria        direct        10.88977</span></span>
<span><span class="co">## 10:  2010 14827 8182222          &lt;NA&gt;        direct        14.44422</span></span>
<span><span class="co">##     stE_povertyRisk</span></span>
<span><span class="co">##               &lt;num&gt;</span></span>
<span><span class="co">##  1:       3.3991522</span></span>
<span><span class="co">##  2:       2.3620627</span></span>
<span><span class="co">##  3:       1.8341926</span></span>
<span><span class="co">##  4:       1.9594194</span></span>
<span><span class="co">##  5:       2.2114469</span></span>
<span><span class="co">##  6:       1.4586851</span></span>
<span><span class="co">##  7:       1.4168992</span></span>
<span><span class="co">##  8:       0.5100449</span></span>
<span><span class="co">##  9:       0.7019211</span></span>
<span><span class="co">## 10:       0.5270691</span></span></code></pre>
<p>The last row with <code>region = NA</code> denotes the aggregate over
all regions. Note that the columns <code>N</code> and <code>n</code> now
show the weighted and unweighted number of persons in each region.</p>
<div class="section level3">
<h3 id="several-grouping-variables">Several grouping variables<a class="anchor" aria-label="anchor" href="#several-grouping-variables"></a>
</h3>
<p>In case more than one grouping variable is used, there are several
options of calling <code><a href="../reference/calc.stError.html">calc.stError()</a></code> depending on whether
combinations of grouping levels should be regarded or not. We will
consider the variables <code>gender</code> and <code>region</code> as
our grouping variables and show three options on how
<code><a href="../reference/calc.stError.html">calc.stError()</a></code> can be called.</p>
<div class="section level4">
<h4 id="option-1-all-regions-and-all-genders">Option 1: All regions and all genders<a class="anchor" aria-label="anchor" href="#option-1-all-regions-and-all-genders"></a>
</h4>
<p>Calculate the point estimate and standard error for each region and
each gender. The number of rows in the output is therefore</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mtext mathvariant="normal">periods</mtext></msub><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>n</mi><mtext mathvariant="normal">regions</mtext></msub><mo>+</mo><msub><mi>n</mi><mtext mathvariant="normal">genders</mtext></msub><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>9</mn><mo>+</mo><mn>2</mn><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>12</mn><mi>.</mi></mrow><annotation encoding="application/x-tex">n_\text{periods}\cdot(n_\text{regions} + n_\text{genders} + 1) = 1\cdot(9 + 2 + 1) = 12.</annotation></semantics></math></p>
<p>The last row is again the estimate for the whole period.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">povertyRates</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc.stError.html">calc.stError</a></span><span class="op">(</span><span class="va">dat2</span>, var <span class="op">=</span> <span class="st">"povertyRisk"</span>, fun <span class="op">=</span> <span class="va">weightedRatio</span>, </span>
<span>                             group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gender"</span>, <span class="st">"region"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">povertyRates</span><span class="op">$</span><span class="va">Estimates</span></span></code></pre></div>
<pre><code><span><span class="co">## Key: &lt;year, n, N, gender, region, estimate_type&gt;</span></span>
<span><span class="co">##      year     n       N gender        region estimate_type val_povertyRisk</span></span>
<span><span class="co">##     &lt;num&gt; &lt;int&gt;   &lt;num&gt; &lt;fctr&gt;        &lt;fctr&gt;        &lt;char&gt;           &lt;num&gt;</span></span>
<span><span class="co">##  1:  2010   549  260564   &lt;NA&gt;    Burgenland        direct        19.53984</span></span>
<span><span class="co">##  2:  2010   733  377355   &lt;NA&gt;    Vorarlberg        direct        16.53731</span></span>
<span><span class="co">##  3:  2010   924  535451   &lt;NA&gt;      Salzburg        direct        13.78734</span></span>
<span><span class="co">##  4:  2010  1078  563648   &lt;NA&gt;     Carinthia        direct        13.08627</span></span>
<span><span class="co">##  5:  2010  1317  701899   &lt;NA&gt;         Tyrol        direct        15.30819</span></span>
<span><span class="co">##  6:  2010  2295 1167045   &lt;NA&gt;        Styria        direct        14.37464</span></span>
<span><span class="co">##  7:  2010  2322 1598931   &lt;NA&gt;        Vienna        direct        17.23468</span></span>
<span><span class="co">##  8:  2010  2804 1555709   &lt;NA&gt; Lower Austria        direct        13.84362</span></span>
<span><span class="co">##  9:  2010  2805 1421620   &lt;NA&gt; Upper Austria        direct        10.88977</span></span>
<span><span class="co">## 10:  2010  7267 3979572   male          &lt;NA&gt;        direct        12.02660</span></span>
<span><span class="co">## 11:  2010  7560 4202650 female          &lt;NA&gt;        direct        16.73351</span></span>
<span><span class="co">## 12:  2010 14827 8182222   &lt;NA&gt;          &lt;NA&gt;        direct        14.44422</span></span>
<span><span class="co">##     stE_povertyRisk</span></span>
<span><span class="co">##               &lt;num&gt;</span></span>
<span><span class="co">##  1:       3.3991522</span></span>
<span><span class="co">##  2:       2.3620627</span></span>
<span><span class="co">##  3:       1.8341926</span></span>
<span><span class="co">##  4:       1.9594194</span></span>
<span><span class="co">##  5:       2.2114469</span></span>
<span><span class="co">##  6:       1.4586851</span></span>
<span><span class="co">##  7:       1.4168992</span></span>
<span><span class="co">##  8:       0.5100449</span></span>
<span><span class="co">##  9:       0.7019211</span></span>
<span><span class="co">## 10:       0.5873095</span></span>
<span><span class="co">## 11:       0.5651648</span></span>
<span><span class="co">## 12:       0.5270691</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="option-2-all-combinations-of-region-and-gender">Option 2: All combinations of <code>region</code> and
<code>gender</code><a class="anchor" aria-label="anchor" href="#option-2-all-combinations-of-region-and-gender"></a>
</h4>
<p>Split the data by all combinations of the two grouping variables.
This will result in a larger output-table of the size</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mtext mathvariant="normal">periods</mtext></msub><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>n</mi><mtext mathvariant="normal">regions</mtext></msub><mo>⋅</mo><msub><mi>n</mi><mtext mathvariant="normal">genders</mtext></msub><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>9</mn><mo>⋅</mo><mn>2</mn><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>19</mn><mi>.</mi></mrow><annotation encoding="application/x-tex">n_\text{periods}\cdot(n_\text{regions} \cdot n_\text{genders} + 1) = 1\cdot(9\cdot2 + 1)= 19.</annotation></semantics></math></p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">povertyRates</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc.stError.html">calc.stError</a></span><span class="op">(</span><span class="va">dat2</span>, var <span class="op">=</span> <span class="st">"povertyRisk"</span>, fun <span class="op">=</span> <span class="va">weightedRatio</span>, </span>
<span>                             group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gender"</span>, <span class="st">"region"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">povertyRates</span><span class="op">$</span><span class="va">Estimates</span></span></code></pre></div>
<pre><code><span><span class="co">## Key: &lt;year, n, N, gender, region, estimate_type&gt;</span></span>
<span><span class="co">##      year     n         N gender        region estimate_type val_povertyRisk</span></span>
<span><span class="co">##     &lt;num&gt; &lt;int&gt;     &lt;num&gt; &lt;fctr&gt;        &lt;fctr&gt;        &lt;char&gt;           &lt;num&gt;</span></span>
<span><span class="co">##  1:  2010   261  122741.8   male    Burgenland        direct       17.414524</span></span>
<span><span class="co">##  2:  2010   288  137822.2 female    Burgenland        direct       21.432598</span></span>
<span><span class="co">##  3:  2010   359  182732.9   male    Vorarlberg        direct       12.973259</span></span>
<span><span class="co">##  4:  2010   374  194622.1 female    Vorarlberg        direct       19.883637</span></span>
<span><span class="co">##  5:  2010   440  253143.7   male      Salzburg        direct        9.156964</span></span>
<span><span class="co">##  6:  2010   484  282307.3 female      Salzburg        direct       17.939382</span></span>
<span><span class="co">##  7:  2010   517  268581.4   male     Carinthia        direct       10.552149</span></span>
<span><span class="co">##  8:  2010   561  295066.6 female     Carinthia        direct       15.392924</span></span>
<span><span class="co">##  9:  2010   650  339566.5   male         Tyrol        direct       12.857542</span></span>
<span><span class="co">## 10:  2010   667  362332.5 female         Tyrol        direct       17.604861</span></span>
<span><span class="co">## 11:  2010  1128  571011.7   male        Styria        direct       11.671247</span></span>
<span><span class="co">## 12:  2010  1132  774405.4   male        Vienna        direct       15.590616</span></span>
<span><span class="co">## 13:  2010  1167  596033.3 female        Styria        direct       16.964539</span></span>
<span><span class="co">## 14:  2010  1190  824525.6 female        Vienna        direct       18.778813</span></span>
<span><span class="co">## 15:  2010  1363  684272.5   male Upper Austria        direct        9.074690</span></span>
<span><span class="co">## 16:  2010  1387  772593.2 female Lower Austria        direct       16.372949</span></span>
<span><span class="co">## 17:  2010  1417  783115.8   male Lower Austria        direct       11.348283</span></span>
<span><span class="co">## 18:  2010  1442  737347.5 female Upper Austria        direct       12.574206</span></span>
<span><span class="co">## 19:  2010 14827 8182222.0   &lt;NA&gt;          &lt;NA&gt;        direct       14.444218</span></span>
<span><span class="co">##     stE_povertyRisk</span></span>
<span><span class="co">##               &lt;num&gt;</span></span>
<span><span class="co">##  1:       3.1646697</span></span>
<span><span class="co">##  2:       3.8897842</span></span>
<span><span class="co">##  3:       2.6647476</span></span>
<span><span class="co">##  4:       2.7081376</span></span>
<span><span class="co">##  5:       1.9178036</span></span>
<span><span class="co">##  6:       1.8838821</span></span>
<span><span class="co">##  7:       2.1096798</span></span>
<span><span class="co">##  8:       1.9910819</span></span>
<span><span class="co">##  9:       2.4959129</span></span>
<span><span class="co">## 10:       2.2702111</span></span>
<span><span class="co">## 11:       1.1800110</span></span>
<span><span class="co">## 12:       1.3589333</span></span>
<span><span class="co">## 13:       1.8695588</span></span>
<span><span class="co">## 14:       1.7127098</span></span>
<span><span class="co">## 15:       0.7922700</span></span>
<span><span class="co">## 16:       0.8264087</span></span>
<span><span class="co">## 17:       0.6345035</span></span>
<span><span class="co">## 18:       0.6702610</span></span>
<span><span class="co">## 19:       0.5270691</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="option-3-cobination-of-option-1-and-option-2">Option 3: Cobination of Option 1 and Option 2<a class="anchor" aria-label="anchor" href="#option-3-cobination-of-option-1-and-option-2"></a>
</h4>
<p>In this case, the estimates and standard errors are calculated
for</p>
<ul>
<li>every gender,</li>
<li>every region and</li>
<li>every combination of region and gender.</li>
</ul>
<p>The number of rows in the output is therefore</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mtext mathvariant="normal">periods</mtext></msub><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>n</mi><mtext mathvariant="normal">regions</mtext></msub><mo>⋅</mo><msub><mi>n</mi><mtext mathvariant="normal">genders</mtext></msub><mo>+</mo><msub><mi>n</mi><mtext mathvariant="normal">regions</mtext></msub><mo>+</mo><msub><mi>n</mi><mtext mathvariant="normal">genders</mtext></msub><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>9</mn><mo>⋅</mo><mn>2</mn><mo>+</mo><mn>9</mn><mo>+</mo><mn>2</mn><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>30</mn><mi>.</mi></mrow><annotation encoding="application/x-tex">n_\text{periods}\cdot(n_\text{regions} \cdot n_\text{genders} + n_\text{regions} + n_\text{genders} + 1) = 1\cdot(9\cdot2 + 9 + 2 + 1) = 30.</annotation></semantics></math></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">povertyRates</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc.stError.html">calc.stError</a></span><span class="op">(</span><span class="va">dat2</span>, var <span class="op">=</span> <span class="st">"povertyRisk"</span>, fun <span class="op">=</span> <span class="va">weightedRatio</span>, </span>
<span>                             group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"gender"</span>, <span class="st">"region"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gender"</span>, <span class="st">"region"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">povertyRates</span><span class="op">$</span><span class="va">Estimates</span></span></code></pre></div>
<pre><code><span><span class="co">## Key: &lt;year, n, N, gender, region, estimate_type&gt;</span></span>
<span><span class="co">##      year     n         N gender        region estimate_type val_povertyRisk</span></span>
<span><span class="co">##     &lt;num&gt; &lt;int&gt;     &lt;num&gt; &lt;fctr&gt;        &lt;fctr&gt;        &lt;char&gt;           &lt;num&gt;</span></span>
<span><span class="co">##  1:  2010   261  122741.8   male    Burgenland        direct       17.414524</span></span>
<span><span class="co">##  2:  2010   288  137822.2 female    Burgenland        direct       21.432598</span></span>
<span><span class="co">##  3:  2010   359  182732.9   male    Vorarlberg        direct       12.973259</span></span>
<span><span class="co">##  4:  2010   374  194622.1 female    Vorarlberg        direct       19.883637</span></span>
<span><span class="co">##  5:  2010   440  253143.7   male      Salzburg        direct        9.156964</span></span>
<span><span class="co">##  6:  2010   484  282307.3 female      Salzburg        direct       17.939382</span></span>
<span><span class="co">##  7:  2010   517  268581.4   male     Carinthia        direct       10.552149</span></span>
<span><span class="co">##  8:  2010   549  260564.0   &lt;NA&gt;    Burgenland        direct       19.539837</span></span>
<span><span class="co">##  9:  2010   561  295066.6 female     Carinthia        direct       15.392924</span></span>
<span><span class="co">## 10:  2010   650  339566.5   male         Tyrol        direct       12.857542</span></span>
<span><span class="co">## 11:  2010   667  362332.5 female         Tyrol        direct       17.604861</span></span>
<span><span class="co">## 12:  2010   733  377355.0   &lt;NA&gt;    Vorarlberg        direct       16.537310</span></span>
<span><span class="co">## 13:  2010   924  535451.0   &lt;NA&gt;      Salzburg        direct       13.787343</span></span>
<span><span class="co">## 14:  2010  1078  563648.0   &lt;NA&gt;     Carinthia        direct       13.086268</span></span>
<span><span class="co">## 15:  2010  1128  571011.7   male        Styria        direct       11.671247</span></span>
<span><span class="co">## 16:  2010  1132  774405.4   male        Vienna        direct       15.590616</span></span>
<span><span class="co">## 17:  2010  1167  596033.3 female        Styria        direct       16.964539</span></span>
<span><span class="co">## 18:  2010  1190  824525.6 female        Vienna        direct       18.778813</span></span>
<span><span class="co">## 19:  2010  1317  701899.0   &lt;NA&gt;         Tyrol        direct       15.308190</span></span>
<span><span class="co">## 20:  2010  1363  684272.5   male Upper Austria        direct        9.074690</span></span>
<span><span class="co">## 21:  2010  1387  772593.2 female Lower Austria        direct       16.372949</span></span>
<span><span class="co">## 22:  2010  1417  783115.8   male Lower Austria        direct       11.348283</span></span>
<span><span class="co">## 23:  2010  1442  737347.5 female Upper Austria        direct       12.574206</span></span>
<span><span class="co">## 24:  2010  2295 1167045.0   &lt;NA&gt;        Styria        direct       14.374637</span></span>
<span><span class="co">## 25:  2010  2322 1598931.0   &lt;NA&gt;        Vienna        direct       17.234683</span></span>
<span><span class="co">## 26:  2010  2804 1555709.0   &lt;NA&gt; Lower Austria        direct       13.843623</span></span>
<span><span class="co">## 27:  2010  2805 1421620.0   &lt;NA&gt; Upper Austria        direct       10.889773</span></span>
<span><span class="co">## 28:  2010  7267 3979571.7   male          &lt;NA&gt;        direct       12.026600</span></span>
<span><span class="co">## 29:  2010  7560 4202650.3 female          &lt;NA&gt;        direct       16.733508</span></span>
<span><span class="co">## 30:  2010 14827 8182222.0   &lt;NA&gt;          &lt;NA&gt;        direct       14.444218</span></span>
<span><span class="co">##      year     n         N gender        region estimate_type val_povertyRisk</span></span>
<span><span class="co">##     stE_povertyRisk</span></span>
<span><span class="co">##               &lt;num&gt;</span></span>
<span><span class="co">##  1:       3.1646697</span></span>
<span><span class="co">##  2:       3.8897842</span></span>
<span><span class="co">##  3:       2.6647476</span></span>
<span><span class="co">##  4:       2.7081376</span></span>
<span><span class="co">##  5:       1.9178036</span></span>
<span><span class="co">##  6:       1.8838821</span></span>
<span><span class="co">##  7:       2.1096798</span></span>
<span><span class="co">##  8:       3.3991522</span></span>
<span><span class="co">##  9:       1.9910819</span></span>
<span><span class="co">## 10:       2.4959129</span></span>
<span><span class="co">## 11:       2.2702111</span></span>
<span><span class="co">## 12:       2.3620627</span></span>
<span><span class="co">## 13:       1.8341926</span></span>
<span><span class="co">## 14:       1.9594194</span></span>
<span><span class="co">## 15:       1.1800110</span></span>
<span><span class="co">## 16:       1.3589333</span></span>
<span><span class="co">## 17:       1.8695588</span></span>
<span><span class="co">## 18:       1.7127098</span></span>
<span><span class="co">## 19:       2.2114469</span></span>
<span><span class="co">## 20:       0.7922700</span></span>
<span><span class="co">## 21:       0.8264087</span></span>
<span><span class="co">## 22:       0.6345035</span></span>
<span><span class="co">## 23:       0.6702610</span></span>
<span><span class="co">## 24:       1.4586851</span></span>
<span><span class="co">## 25:       1.4168992</span></span>
<span><span class="co">## 26:       0.5100449</span></span>
<span><span class="co">## 27:       0.7019211</span></span>
<span><span class="co">## 28:       0.5873095</span></span>
<span><span class="co">## 29:       0.5651648</span></span>
<span><span class="co">## 30:       0.5270691</span></span>
<span><span class="co">##     stE_povertyRisk</span></span></code></pre>
</div>
</div>
</div>
<div class="section level2">
<h2 id="group-differences">Group differences<a class="anchor" aria-label="anchor" href="#group-differences"></a>
</h2>
<p>If differences between groups need to be calculated, e.g difference
of poverty rates between <code>gender = "male"</code> and
<code>gender = "female"</code>, parameter <code>group.diff</code> can be
utilised. Setting <code>group.diff = TRUE</code> the differences and the
standard error of these differences for all variables defined in
<code>groups</code> will be calculated.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">povertyRates</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc.stError.html">calc.stError</a></span><span class="op">(</span><span class="va">dat2</span>, var <span class="op">=</span> <span class="st">"povertyRisk"</span>, fun <span class="op">=</span> <span class="va">weightedRatio</span>, </span>
<span>                             group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gender"</span>, <span class="st">"region"</span><span class="op">)</span>,</span>
<span>                             group.diff <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">povertyRates</span><span class="op">$</span><span class="va">Estimates</span></span></code></pre></div>
<pre><code><span><span class="co">## Key: &lt;year, n, N, gender, region, estimate_type&gt;</span></span>
<span><span class="co">##      year       n         N        gender                        region</span></span>
<span><span class="co">##     &lt;num&gt;   &lt;num&gt;     &lt;num&gt;        &lt;fctr&gt;                        &lt;fctr&gt;</span></span>
<span><span class="co">##  1:  2010   549.0  260564.0          &lt;NA&gt;                    Burgenland</span></span>
<span><span class="co">##  2:  2010   641.0  318959.5          &lt;NA&gt;       Burgenland - Vorarlberg</span></span>
<span><span class="co">##  3:  2010   733.0  377355.0          &lt;NA&gt;                    Vorarlberg</span></span>
<span><span class="co">##  4:  2010   736.5  398007.5          &lt;NA&gt;         Burgenland - Salzburg</span></span>
<span><span class="co">##  5:  2010   813.5  412106.0          &lt;NA&gt;        Burgenland - Carinthia</span></span>
<span><span class="co">##  6:  2010   828.5  456403.0          &lt;NA&gt;         Salzburg - Vorarlberg</span></span>
<span><span class="co">##  7:  2010   905.5  470501.5          &lt;NA&gt;        Carinthia - Vorarlberg</span></span>
<span><span class="co">##  8:  2010   924.0  535451.0          &lt;NA&gt;                      Salzburg</span></span>
<span><span class="co">##  9:  2010   933.0  481231.5          &lt;NA&gt;            Burgenland - Tyrol</span></span>
<span><span class="co">## 10:  2010  1001.0  549549.5          &lt;NA&gt;          Carinthia - Salzburg</span></span>
<span><span class="co">## 11:  2010  1025.0  539627.0          &lt;NA&gt;            Tyrol - Vorarlberg</span></span>
<span><span class="co">## 12:  2010  1078.0  563648.0          &lt;NA&gt;                     Carinthia</span></span>
<span><span class="co">## 13:  2010  1120.5  618675.0          &lt;NA&gt;              Salzburg - Tyrol</span></span>
<span><span class="co">## 14:  2010  1197.5  632773.5          &lt;NA&gt;             Carinthia - Tyrol</span></span>
<span><span class="co">## 15:  2010  1317.0  701899.0          &lt;NA&gt;                         Tyrol</span></span>
<span><span class="co">## 16:  2010  1422.0  713804.5          &lt;NA&gt;           Burgenland - Styria</span></span>
<span><span class="co">## 17:  2010  1435.5  929747.5          &lt;NA&gt;           Burgenland - Vienna</span></span>
<span><span class="co">## 18:  2010  1514.0  772200.0          &lt;NA&gt;           Styria - Vorarlberg</span></span>
<span><span class="co">## 19:  2010  1527.5  988143.0          &lt;NA&gt;           Vienna - Vorarlberg</span></span>
<span><span class="co">## 20:  2010  1609.5  851248.0          &lt;NA&gt;             Salzburg - Styria</span></span>
<span><span class="co">## 21:  2010  1623.0 1067191.0          &lt;NA&gt;             Salzburg - Vienna</span></span>
<span><span class="co">## 22:  2010  1676.5  908136.5          &lt;NA&gt;    Burgenland - Lower Austria</span></span>
<span><span class="co">## 23:  2010  1677.0  841092.0          &lt;NA&gt;    Burgenland - Upper Austria</span></span>
<span><span class="co">## 24:  2010  1686.5  865346.5          &lt;NA&gt;            Carinthia - Styria</span></span>
<span><span class="co">## 25:  2010  1700.0 1081289.5          &lt;NA&gt;            Carinthia - Vienna</span></span>
<span><span class="co">## 26:  2010  1768.5  966532.0          &lt;NA&gt;    Lower Austria - Vorarlberg</span></span>
<span><span class="co">## 27:  2010  1769.0  899487.5          &lt;NA&gt;    Upper Austria - Vorarlberg</span></span>
<span><span class="co">## 28:  2010  1806.0  934472.0          &lt;NA&gt;                Styria - Tyrol</span></span>
<span><span class="co">## 29:  2010  1819.5 1150415.0          &lt;NA&gt;                Tyrol - Vienna</span></span>
<span><span class="co">## 30:  2010  1864.0 1045580.0          &lt;NA&gt;      Lower Austria - Salzburg</span></span>
<span><span class="co">## 31:  2010  1864.5  978535.5          &lt;NA&gt;      Salzburg - Upper Austria</span></span>
<span><span class="co">## 32:  2010  1941.0 1059678.5          &lt;NA&gt;     Carinthia - Lower Austria</span></span>
<span><span class="co">## 33:  2010  1941.5  992634.0          &lt;NA&gt;     Carinthia - Upper Austria</span></span>
<span><span class="co">## 34:  2010  2060.5 1128804.0          &lt;NA&gt;         Lower Austria - Tyrol</span></span>
<span><span class="co">## 35:  2010  2061.0 1061759.5          &lt;NA&gt;         Tyrol - Upper Austria</span></span>
<span><span class="co">## 36:  2010  2295.0 1167045.0          &lt;NA&gt;                        Styria</span></span>
<span><span class="co">## 37:  2010  2308.5 1382988.0          &lt;NA&gt;               Styria - Vienna</span></span>
<span><span class="co">## 38:  2010  2322.0 1598931.0          &lt;NA&gt;                        Vienna</span></span>
<span><span class="co">## 39:  2010  2549.5 1361377.0          &lt;NA&gt;        Lower Austria - Styria</span></span>
<span><span class="co">## 40:  2010  2550.0 1294332.5          &lt;NA&gt;        Styria - Upper Austria</span></span>
<span><span class="co">## 41:  2010  2563.0 1577320.0          &lt;NA&gt;        Lower Austria - Vienna</span></span>
<span><span class="co">## 42:  2010  2563.5 1510275.5          &lt;NA&gt;        Upper Austria - Vienna</span></span>
<span><span class="co">## 43:  2010  2804.0 1555709.0          &lt;NA&gt;                 Lower Austria</span></span>
<span><span class="co">## 44:  2010  2804.5 1488664.5          &lt;NA&gt; Lower Austria - Upper Austria</span></span>
<span><span class="co">## 45:  2010  2805.0 1421620.0          &lt;NA&gt;                 Upper Austria</span></span>
<span><span class="co">## 46:  2010  7267.0 3979571.7          male                          &lt;NA&gt;</span></span>
<span><span class="co">## 47:  2010  7413.5 4091111.0 male - female                          &lt;NA&gt;</span></span>
<span><span class="co">## 48:  2010  7560.0 4202650.3        female                          &lt;NA&gt;</span></span>
<span><span class="co">## 49:  2010 14827.0 8182222.0          &lt;NA&gt;                          &lt;NA&gt;</span></span>
<span><span class="co">##      year       n         N        gender                        region</span></span>
<span><span class="co">##        estimate_type val_povertyRisk stE_povertyRisk</span></span>
<span><span class="co">##               &lt;char&gt;           &lt;num&gt;           &lt;num&gt;</span></span>
<span><span class="co">##  1:           direct     19.53983651       3.3991522</span></span>
<span><span class="co">##  2: group difference      3.00252634       4.4890631</span></span>
<span><span class="co">##  3:           direct     16.53731017       2.3620627</span></span>
<span><span class="co">##  4: group difference      5.75249330       4.1975326</span></span>
<span><span class="co">##  5: group difference      6.45356876       3.0539134</span></span>
<span><span class="co">##  6: group difference     -2.74996696       3.6206158</span></span>
<span><span class="co">##  7: group difference     -3.45104242       3.5988502</span></span>
<span><span class="co">##  8:           direct     13.78734321       1.8341926</span></span>
<span><span class="co">##  9: group difference      4.23164602       4.4681770</span></span>
<span><span class="co">## 10: group difference     -0.70107546       2.7972395</span></span>
<span><span class="co">## 11: group difference     -1.22911968       3.8654808</span></span>
<span><span class="co">## 12:           direct     13.08626775       1.9594194</span></span>
<span><span class="co">## 13: group difference     -1.52084728       2.5416485</span></span>
<span><span class="co">## 14: group difference     -2.22192274       2.7594977</span></span>
<span><span class="co">## 15:           direct     15.30819049       2.2114469</span></span>
<span><span class="co">## 16: group difference      5.16519923       3.6039864</span></span>
<span><span class="co">## 17: group difference      2.30515330       3.6009324</span></span>
<span><span class="co">## 18: group difference     -2.16267289       2.8637972</span></span>
<span><span class="co">## 19: group difference      0.69737304       2.3743461</span></span>
<span><span class="co">## 20: group difference     -0.58729407       2.3165526</span></span>
<span><span class="co">## 21: group difference     -3.44734000       1.9904090</span></span>
<span><span class="co">## 22: group difference      5.69621369       3.1218080</span></span>
<span><span class="co">## 23: group difference      8.65006312       3.0035391</span></span>
<span><span class="co">## 24: group difference     -1.28836953       2.5145765</span></span>
<span><span class="co">## 25: group difference     -4.14841546       2.3878714</span></span>
<span><span class="co">## 26: group difference     -2.69368735       2.4681264</span></span>
<span><span class="co">## 27: group difference     -5.64753678       2.4296656</span></span>
<span><span class="co">## 28: group difference     -0.93355321       3.1420647</span></span>
<span><span class="co">## 29: group difference     -1.92649272       2.6290236</span></span>
<span><span class="co">## 30: group difference      0.05627961       1.9652603</span></span>
<span><span class="co">## 31: group difference      2.89756982       1.8031549</span></span>
<span><span class="co">## 32: group difference     -0.75735506       1.9223843</span></span>
<span><span class="co">## 33: group difference      2.19649436       2.0354113</span></span>
<span><span class="co">## 34: group difference     -1.46456768       2.5638175</span></span>
<span><span class="co">## 35: group difference      4.41841710       2.4601908</span></span>
<span><span class="co">## 36:           direct     14.37463728       1.4586851</span></span>
<span><span class="co">## 37: group difference     -2.86004593       1.8618960</span></span>
<span><span class="co">## 38:           direct     17.23468321       1.4168992</span></span>
<span><span class="co">## 39: group difference     -0.53101447       1.0945146</span></span>
<span><span class="co">## 40: group difference      3.48486389       1.8391376</span></span>
<span><span class="co">## 41: group difference     -3.39106040       1.4503756</span></span>
<span><span class="co">## 42: group difference     -6.34490982       1.3856792</span></span>
<span><span class="co">## 43:           direct     13.84362281       0.5100449</span></span>
<span><span class="co">## 44: group difference      2.95384943       0.8351912</span></span>
<span><span class="co">## 45:           direct     10.88977339       0.7019211</span></span>
<span><span class="co">## 46:           direct     12.02659998       0.5873095</span></span>
<span><span class="co">## 47: group difference     -4.70690810       0.4610436</span></span>
<span><span class="co">## 48:           direct     16.73350808       0.5651648</span></span>
<span><span class="co">## 49:           direct     14.44421817       0.5270691</span></span>
<span><span class="co">##        estimate_type val_povertyRisk stE_povertyRisk</span></span></code></pre>
<p>The resulting output table contains 49 rows. 12 rows for all the
direct estimators</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mtext mathvariant="normal">periods</mtext></msub><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>n</mi><mtext mathvariant="normal">regions</mtext></msub><mo>+</mo><msub><mi>n</mi><mtext mathvariant="normal">genders</mtext></msub><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>9</mn><mo>+</mo><mn>2</mn><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>12</mn><mo>,</mo></mrow><annotation encoding="application/x-tex">n_\text{periods}\cdot(n_\text{regions} + n_\text{genders} + 1) = 1\cdot(9 + 2 + 1) = 12,</annotation></semantics></math></p>
<p>and another 37 for all the differences within the variable
<code>"gender"</code> and <code>"region"</code> seperately. Variable
<code>"gender"</code> has 2 unique values
(<code>unique(dat2$gender)</code>) resulting in 1 difference, ~
<code>gender = "male"</code> - <code>gender = "female"</code> and
variable <code>"region"</code> has 9 unique values
(<code>unique(dat2$region)</code>) resulting in</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>8</mn><mo>+</mo><mn>7</mn><mo>+</mo><mn>6</mn><mo>+</mo><mn>5</mn><mo>+</mo><mn>4</mn><mo>+</mo><mn>3</mn><mo>+</mo><mn>2</mn><mo>+</mo><mn>1</mn><mo>=</mo><munderover><mo>∑</mo><mrow><mn>1</mn><mo>=</mo><mn>1</mn></mrow><mrow><mn>9</mn><mo>−</mo><mn>1</mn></mrow></munderover><mi>i</mi><mo>=</mo><mn>36</mn></mrow><annotation encoding="application/x-tex">8 + 7 + 6 + 5 + 4 + 3 + 2 + 1  = \sum\limits_{1=1}^{9-1}i = 36</annotation></semantics></math></p>
<p>estimates. Thus the output contains 1 + 36 = 37 estimates with
respect to group differences.</p>
<p>If a combintaion of grouping variables is used in <code>group</code>
and <code>group.diff = TRUE</code> then differences between combinations
will only be calculated if one of the grouping variables differs. For
example the difference between the following groups would be
calculated</p>
<ul>
<li>
<code>gender = "female" &amp; region = "Vienna"</code> -
<code>gender = "male" &amp; region = "Vienna"</code>
</li>
<li>
<code>gender = "female" &amp; region = "Vienna"</code> -
<code>gender = "female" &amp; region = "Salzburg"</code>
</li>
<li>
<code>gender = "male" &amp; region = "Salzburg"</code> -
<code>gender = "female" &amp; region = "Salzburg"</code>
</li>
</ul>
<p>The difference between
<code>gender = "female" &amp; region = "Vienna"</code> and
<code>gender = "male" &amp; region = "Salzburg"</code> however would not
be calculated.</p>
<p>Thus this leads to</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><munderover><mo>∑</mo><mrow><mn>1</mn><mo>=</mo><mn>1</mn></mrow><mrow><mn>9</mn><mo>−</mo><mn>1</mn></mrow></munderover><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mn>9</mn><mo>⋅</mo><mn>1</mn><mo>=</mo><mn>81</mn></mrow><annotation encoding="application/x-tex">2\cdot(\sum\limits_{1=1}^{9-1}i) + 9\cdot1 = 81</annotation></semantics></math></p>
<p>results with respect to the differences. The Output contains an
additional column <code>estimate_type</code> and</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">povertyRates</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc.stError.html">calc.stError</a></span><span class="op">(</span><span class="va">dat2</span>, var <span class="op">=</span> <span class="st">"povertyRisk"</span>, fun <span class="op">=</span> <span class="va">weightedRatio</span>, </span>
<span>                             group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gender"</span>, <span class="st">"region"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                             group.diff <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">povertyRates</span><span class="op">$</span><span class="va">Estimates</span><span class="op">[</span>,<span class="va">.N</span>,by<span class="op">=</span><span class="fu">.</span><span class="op">(</span><span class="va">estimate_type</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##       estimate_type     N</span></span>
<span><span class="co">##              &lt;char&gt; &lt;int&gt;</span></span>
<span><span class="co">## 1:           direct    19</span></span>
<span><span class="co">## 2: group difference    81</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="differences-between-survey-periods">Differences between survey periods<a class="anchor" aria-label="anchor" href="#differences-between-survey-periods"></a>
</h2>
<p>Differences of estimates between <code>period</code>s can be
calculated using parameter <code>period.diff</code>.
<code>period.diff</code> expects a character vector (if not
<code>NULL</code>) specifying for which <code>period</code>s the
differences should be calcualed for. The inputs should be specified in
the form <code>"period2" - "period1"</code>.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">povertyRates</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc.stError.html">calc.stError</a></span><span class="op">(</span><span class="va">dat_boot_calib</span><span class="op">[</span><span class="va">year</span><span class="op">&gt;</span><span class="fl">2013</span><span class="op">]</span>, var <span class="op">=</span> <span class="st">"povertyRisk"</span>, fun <span class="op">=</span> <span class="va">weightedRatio</span>, </span>
<span>                             period.diff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2017 - 2016"</span>, <span class="st">"2016 - 2015"</span>, <span class="st">"2015 - 2014"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">povertyRates</span><span class="op">$</span><span class="va">Estimates</span></span></code></pre></div>
<pre><code><span><span class="co">## Key: &lt;year, n, N, estimate_type&gt;</span></span>
<span><span class="co">##         year     n       N     estimate_type val_povertyRisk stE_povertyRisk</span></span>
<span><span class="co">##       &lt;char&gt; &lt;num&gt;   &lt;num&gt;            &lt;char&gt;           &lt;num&gt;           &lt;num&gt;</span></span>
<span><span class="co">## 1:      2014 14827 8182222            direct      15.1455601       0.4480311</span></span>
<span><span class="co">## 2:      2015 14827 8182222            direct      15.5364014       0.4478586</span></span>
<span><span class="co">## 3: 2015-2014 14827 8182222 period difference       0.3908413       0.3521572</span></span>
<span><span class="co">## 4:      2016 14827 8182222            direct      15.0831502       0.4738048</span></span>
<span><span class="co">## 5: 2016-2015 14827 8182222 period difference      -0.4532512       0.3592894</span></span>
<span><span class="co">## 6:      2017 14827 8182222            direct      15.4201916       0.5273047</span></span>
<span><span class="co">## 7: 2017-2016 14827 8182222 period difference       0.3370414       0.2163653</span></span></code></pre>
<p>If additional grouping variables are supplied to
<code><a href="../reference/calc.stError.html">calc.stError()</a></code> die differences across <code>period</code>s
are also carried out for all variables in <code>group</code>.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">povertyRates</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc.stError.html">calc.stError</a></span><span class="op">(</span><span class="va">dat_boot_calib</span><span class="op">[</span><span class="va">year</span><span class="op">&gt;</span><span class="fl">2013</span><span class="op">]</span>, var <span class="op">=</span> <span class="st">"povertyRisk"</span>, fun <span class="op">=</span> <span class="va">weightedRatio</span>, </span>
<span>                             group <span class="op">=</span> <span class="st">"gender"</span>,</span>
<span>                             period.diff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2017 - 2016"</span>, <span class="st">"2016 - 2015"</span>, <span class="st">"2015 - 2014"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">povertyRates</span><span class="op">$</span><span class="va">Estimates</span></span></code></pre></div>
<pre><code><span><span class="co">## Key: &lt;year, n, N, gender, estimate_type&gt;</span></span>
<span><span class="co">##          year     n       N gender     estimate_type val_povertyRisk</span></span>
<span><span class="co">##        &lt;char&gt; &lt;num&gt;   &lt;num&gt; &lt;fctr&gt;            &lt;char&gt;           &lt;num&gt;</span></span>
<span><span class="co">##  1:      2014  7267 3979572   male            direct      14.5035068</span></span>
<span><span class="co">##  2:      2014  7560 4202650 female            direct      15.7535328</span></span>
<span><span class="co">##  3:      2014 14827 8182222   &lt;NA&gt;            direct      15.1455601</span></span>
<span><span class="co">##  4:      2015  7267 3979572   male            direct      15.1228904</span></span>
<span><span class="co">##  5:      2015  7560 4202650 female            direct      15.9279630</span></span>
<span><span class="co">##  6:      2015 14827 8182222   &lt;NA&gt;            direct      15.5364014</span></span>
<span><span class="co">##  7: 2015-2014  7267 3979572   male period difference       0.6193836</span></span>
<span><span class="co">##  8: 2015-2014  7560 4202650 female period difference       0.1744301</span></span>
<span><span class="co">##  9: 2015-2014 14827 8182222   &lt;NA&gt; period difference       0.3908413</span></span>
<span><span class="co">## 10:      2016  7267 3979572   male            direct      14.5796824</span></span>
<span><span class="co">## 11:      2016  7560 4202650 female            direct      15.5598937</span></span>
<span><span class="co">## 12:      2016 14827 8182222   &lt;NA&gt;            direct      15.0831502</span></span>
<span><span class="co">## 13: 2016-2015  7267 3979572   male period difference      -0.5432080</span></span>
<span><span class="co">## 14: 2016-2015  7560 4202650 female period difference      -0.3680693</span></span>
<span><span class="co">## 15: 2016-2015 14827 8182222   &lt;NA&gt; period difference      -0.4532512</span></span>
<span><span class="co">## 16:      2017  7267 3979572   male            direct      14.9481591</span></span>
<span><span class="co">## 17:      2017  7560 4202650 female            direct      15.8671684</span></span>
<span><span class="co">## 18:      2017 14827 8182222   &lt;NA&gt;            direct      15.4201916</span></span>
<span><span class="co">## 19: 2017-2016  7267 3979572   male period difference       0.3684767</span></span>
<span><span class="co">## 20: 2017-2016  7560 4202650 female period difference       0.3072748</span></span>
<span><span class="co">## 21: 2017-2016 14827 8182222   &lt;NA&gt; period difference       0.3370414</span></span>
<span><span class="co">##          year     n       N gender     estimate_type val_povertyRisk</span></span>
<span><span class="co">##     stE_povertyRisk</span></span>
<span><span class="co">##               &lt;num&gt;</span></span>
<span><span class="co">##  1:       0.6133835</span></span>
<span><span class="co">##  2:       0.4828868</span></span>
<span><span class="co">##  3:       0.4480311</span></span>
<span><span class="co">##  4:       0.6097891</span></span>
<span><span class="co">##  5:       0.3711825</span></span>
<span><span class="co">##  6:       0.4478586</span></span>
<span><span class="co">##  7:       0.3257510</span></span>
<span><span class="co">##  8:       0.4525163</span></span>
<span><span class="co">##  9:       0.3521572</span></span>
<span><span class="co">## 10:       0.5678502</span></span>
<span><span class="co">## 11:       0.4702997</span></span>
<span><span class="co">## 12:       0.4738048</span></span>
<span><span class="co">## 13:       0.4037554</span></span>
<span><span class="co">## 14:       0.4118243</span></span>
<span><span class="co">## 15:       0.3592894</span></span>
<span><span class="co">## 16:       0.6784856</span></span>
<span><span class="co">## 17:       0.4736168</span></span>
<span><span class="co">## 18:       0.5273047</span></span>
<span><span class="co">## 19:       0.3408953</span></span>
<span><span class="co">## 20:       0.1699518</span></span>
<span><span class="co">## 21:       0.2163653</span></span>
<span><span class="co">##     stE_povertyRisk</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="averages-across-periods">Averages across periods<a class="anchor" aria-label="anchor" href="#averages-across-periods"></a>
</h2>
<p>With parameter <code>period.mean</code> averages across
<code>period</code>s are calculated additional. The parameter accepts
only odd integer values. The resulting table will contain the direct
estimates as well as rolling averages of length
<code>period.mean</code>.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">povertyRates</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc.stError.html">calc.stError</a></span><span class="op">(</span><span class="va">dat_boot_calib</span><span class="op">[</span><span class="va">year</span><span class="op">&gt;</span><span class="fl">2013</span><span class="op">]</span>, var <span class="op">=</span> <span class="st">"povertyRisk"</span>, fun <span class="op">=</span> <span class="va">weightedRatio</span>, </span>
<span>                             period.mean <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">povertyRates</span><span class="op">$</span><span class="va">Estimates</span></span></code></pre></div>
<pre><code><span><span class="co">## Key: &lt;year, n, N, estimate_type&gt;</span></span>
<span><span class="co">##              year     n       N  estimate_type val_povertyRisk stE_povertyRisk</span></span>
<span><span class="co">##            &lt;char&gt; &lt;num&gt;   &lt;num&gt;         &lt;char&gt;           &lt;num&gt;           &lt;num&gt;</span></span>
<span><span class="co">## 1:           2014 14827 8182222         direct        15.14556       0.4480311</span></span>
<span><span class="co">## 2: 2014_2015_2016 14827 8182222 period average        15.25504       0.4090587</span></span>
<span><span class="co">## 3:           2015 14827 8182222         direct        15.53640       0.4478586</span></span>
<span><span class="co">## 4: 2015_2016_2017 14827 8182222 period average        15.34658       0.4544507</span></span>
<span><span class="co">## 5:           2016 14827 8182222         direct        15.08315       0.4738048</span></span>
<span><span class="co">## 6:           2017 14827 8182222         direct        15.42019       0.5273047</span></span></code></pre>
<p>if in addition the parameters <code>group</code> and/or
<code>period.diff</code> are specified then differences and groupings of
averages will be calculated.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">povertyRates</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc.stError.html">calc.stError</a></span><span class="op">(</span><span class="va">dat_boot_calib</span><span class="op">[</span><span class="va">year</span><span class="op">&gt;</span><span class="fl">2013</span><span class="op">]</span>, var <span class="op">=</span> <span class="st">"povertyRisk"</span>, fun <span class="op">=</span> <span class="va">weightedRatio</span>, </span>
<span>                             period.mean <span class="op">=</span> <span class="fl">3</span>, period.diff <span class="op">=</span> <span class="st">"2016 - 2015"</span>,</span>
<span>                             group <span class="op">=</span> <span class="st">"gender"</span><span class="op">)</span></span>
<span><span class="va">povertyRates</span><span class="op">$</span><span class="va">Estimates</span></span></code></pre></div>
<pre><code><span><span class="co">## Key: &lt;year, n, N, gender, estimate_type&gt;</span></span>
<span><span class="co">##               year     n       N gender                      estimate_type</span></span>
<span><span class="co">##             &lt;char&gt; &lt;num&gt;   &lt;num&gt; &lt;fctr&gt;                             &lt;char&gt;</span></span>
<span><span class="co">##  1:           2014  7267 3979572   male                             direct</span></span>
<span><span class="co">##  2:           2014  7560 4202650 female                             direct</span></span>
<span><span class="co">##  3:           2014 14827 8182222   &lt;NA&gt;                             direct</span></span>
<span><span class="co">##  4: 2014_2015_2016  7267 3979572   male                     period average</span></span>
<span><span class="co">##  5: 2014_2015_2016  7560 4202650 female                     period average</span></span>
<span><span class="co">##  6: 2014_2015_2016 14827 8182222   &lt;NA&gt;                     period average</span></span>
<span><span class="co">##  7:           2015  7267 3979572   male                             direct</span></span>
<span><span class="co">##  8:           2015  7560 4202650 female                             direct</span></span>
<span><span class="co">##  9:           2015 14827 8182222   &lt;NA&gt;                             direct</span></span>
<span><span class="co">## 10: 2015_2016_2017  7267 3979572   male                     period average</span></span>
<span><span class="co">## 11: 2015_2016_2017  7560 4202650 female                     period average</span></span>
<span><span class="co">## 12: 2015_2016_2017 14827 8182222   &lt;NA&gt;                     period average</span></span>
<span><span class="co">## 13:           2016  7267 3979572   male                             direct</span></span>
<span><span class="co">## 14:           2016  7560 4202650 female                             direct</span></span>
<span><span class="co">## 15:           2016 14827 8182222   &lt;NA&gt;                             direct</span></span>
<span><span class="co">## 16:      2016-2015  7267 3979572   male                  period difference</span></span>
<span><span class="co">## 17:      2016-2015  7560 4202650 female                  period difference</span></span>
<span><span class="co">## 18:      2016-2015 14827 8182222   &lt;NA&gt;                  period difference</span></span>
<span><span class="co">## 19: 2016-2015_mean  7267 3979572   male difference between period averages</span></span>
<span><span class="co">## 20: 2016-2015_mean  7560 4202650 female difference between period averages</span></span>
<span><span class="co">## 21: 2016-2015_mean 14827 8182222   &lt;NA&gt; difference between period averages</span></span>
<span><span class="co">## 22:           2017  7267 3979572   male                             direct</span></span>
<span><span class="co">## 23:           2017  7560 4202650 female                             direct</span></span>
<span><span class="co">## 24:           2017 14827 8182222   &lt;NA&gt;                             direct</span></span>
<span><span class="co">##               year     n       N gender                      estimate_type</span></span>
<span><span class="co">##     val_povertyRisk stE_povertyRisk</span></span>
<span><span class="co">##               &lt;num&gt;           &lt;num&gt;</span></span>
<span><span class="co">##  1:     14.50350682       0.6133835</span></span>
<span><span class="co">##  2:     15.75353283       0.4828868</span></span>
<span><span class="co">##  3:     15.14556006       0.4480311</span></span>
<span><span class="co">##  4:     14.73535987       0.5579253</span></span>
<span><span class="co">##  5:     15.74712982       0.3559449</span></span>
<span><span class="co">##  6:     15.25503720       0.4090587</span></span>
<span><span class="co">##  7:     15.12289042       0.6097891</span></span>
<span><span class="co">##  8:     15.92796296       0.3711825</span></span>
<span><span class="co">##  9:     15.53640136       0.4478586</span></span>
<span><span class="co">## 10:     14.88357729       0.5893327</span></span>
<span><span class="co">## 11:     15.78500836       0.3972314</span></span>
<span><span class="co">## 12:     15.34658105       0.4544507</span></span>
<span><span class="co">## 13:     14.57968239       0.5678502</span></span>
<span><span class="co">## 14:     15.55989368       0.4702997</span></span>
<span><span class="co">## 15:     15.08315018       0.4738048</span></span>
<span><span class="co">## 16:     -0.54320803       0.4037554</span></span>
<span><span class="co">## 17:     -0.36806928       0.4118243</span></span>
<span><span class="co">## 18:     -0.45325118       0.3592894</span></span>
<span><span class="co">## 19:      0.14821741       0.1133492</span></span>
<span><span class="co">## 20:      0.03787854       0.1740948</span></span>
<span><span class="co">## 21:      0.09154385       0.1343757</span></span>
<span><span class="co">## 22:     14.94815906       0.6784856</span></span>
<span><span class="co">## 23:     15.86716845       0.4736168</span></span>
<span><span class="co">## 24:     15.42019160       0.5273047</span></span>
<span><span class="co">##     val_povertyRisk stE_povertyRisk</span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Johannes Gussenbauer, Alexander Kowarik, Eileen Vattheuer, Gregor de Cillia.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
