<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Uncertainty analysis with surveysd • surveysd</title>
<link rel="shortcut icon" type="image/x-icon" href="../favicon.ico">
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Uncertainty analysis with surveysd">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">surveysd</a>
        <span class="label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Methodology.html">Methodology</a>
    </li>
    <li>
      <a href="../articles/uncertainty_analysis.html">Uncertainty analysis with surveysd</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/statistikat/surveysd">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Uncertainty analysis with surveysd</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/statistikat/surveysd/blob/master/vignettes/uncertainty_analysis.Rmd"><code>vignettes/uncertainty_analysis.Rmd</code></a></small>
      <div class="hidden name"><code>uncertainty_analysis.Rmd</code></div>

    </div>

    
    
<p>For the most part, this document will present the functionalities of the function <code><a href="../reference/calc.stError.html">surveysd::calc.stError()</a></code> which generates point estimates and standard errors for user-supplied estimation functions.</p>
<div id="prerequisites" class="section level2">
<h2 class="hasAnchor">
<a href="#prerequisites" class="anchor"></a>Prerequisites</h2>
<p>In order to use a dataset with <code><a href="../reference/calc.stError.html">calc.stError()</a></code>, several weight columns have to be present. Each weight column corresponds to a bootstrap sample. In the following examples, we will use the data from <code><a href="../reference/demo.eusilc.html">demo.eusilc()</a></code> and attach the bootstrap weights using <code><a href="../reference/draw.bootstrap.html">draw.bootstrap()</a></code> and <code><a href="../reference/recalib.html">recalib()</a></code>. Please refer to the documentation of those functions for more detail.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(surveysd)

<span class="kw">set.seed</span>(<span class="dv">1234</span>)
eusilc &lt;-<span class="st"> </span><span class="kw"><a href="../reference/demo.eusilc.html">demo.eusilc</a></span>(<span class="dt">prettyNames =</span> <span class="ot">TRUE</span>)
dat_boot &lt;-<span class="st"> </span><span class="kw"><a href="../reference/draw.bootstrap.html">draw.bootstrap</a></span>(eusilc, <span class="dt">REP =</span> <span class="dv">10</span>, <span class="dt">hid =</span> <span class="st">"hid"</span>, <span class="dt">weights =</span> <span class="st">"pWeight"</span>,
                           <span class="dt">strata =</span> <span class="st">"region"</span>, <span class="dt">period =</span> <span class="st">"year"</span>)
dat_boot_calib &lt;-<span class="st"> </span><span class="kw"><a href="../reference/recalib.html">recalib</a></span>(dat_boot, <span class="dt">conP.var =</span> <span class="st">"gender"</span>, <span class="dt">conH.var =</span> <span class="st">"region"</span>)</code></pre></div>
<pre><code>## Convergence reached in  3  steps 
## Convergence reached in  3  steps 
## Convergence reached in  3  steps 
## Convergence reached in  3  steps 
## Convergence reached in  3  steps 
## Convergence reached in  3  steps 
## Convergence reached in  2  steps 
## Convergence reached in  3  steps 
## Convergence reached in  2  steps 
## Convergence reached in  4  steps</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat_boot_calib[, onePerson <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">nrow</span>(.SD) <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, by =<span class="st"> </span>.(year, hid)]

## print part of the dataset
dat_boot_calib[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, .(year, povertyRisk, eqIncome, onePerson, pWeight, w1, w2, w3, w4, w5)]</code></pre></div>
<div class="kable-table">
<table class="table">
<thead><tr class="header">
<th align="right">year</th>
<th align="left">povertyRisk</th>
<th align="right">eqIncome</th>
<th align="left">onePerson</th>
<th align="right">pWeight</th>
<th align="right">w1</th>
<th align="right">w2</th>
<th align="right">w3</th>
<th align="right">w4</th>
<th align="right">w5</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">2010</td>
<td align="left">FALSE</td>
<td align="right">16090.69</td>
<td align="left">FALSE</td>
<td align="right">504.5696</td>
<td align="right">1008.633</td>
<td align="right">1.199585</td>
<td align="right">1001.005</td>
<td align="right">1.17313</td>
<td align="right">1.18297</td>
</tr>
<tr class="even">
<td align="right">2010</td>
<td align="left">FALSE</td>
<td align="right">16090.69</td>
<td align="left">FALSE</td>
<td align="right">504.5696</td>
<td align="right">1008.633</td>
<td align="right">1.199585</td>
<td align="right">1001.005</td>
<td align="right">1.17313</td>
<td align="right">1.18297</td>
</tr>
<tr class="odd">
<td align="right">2010</td>
<td align="left">FALSE</td>
<td align="right">16090.69</td>
<td align="left">FALSE</td>
<td align="right">504.5696</td>
<td align="right">1008.633</td>
<td align="right">1.199585</td>
<td align="right">1001.005</td>
<td align="right">1.17313</td>
<td align="right">1.18297</td>
</tr>
<tr class="even">
<td align="right">2011</td>
<td align="left">FALSE</td>
<td align="right">16090.69</td>
<td align="left">FALSE</td>
<td align="right">504.5696</td>
<td align="right">1035.097</td>
<td align="right">1.242683</td>
<td align="right">1029.522</td>
<td align="right">1.19953</td>
<td align="right">1.17907</td>
</tr>
<tr class="odd">
<td align="right">2011</td>
<td align="left">FALSE</td>
<td align="right">16090.69</td>
<td align="left">FALSE</td>
<td align="right">504.5696</td>
<td align="right">1035.097</td>
<td align="right">1.242683</td>
<td align="right">1029.522</td>
<td align="right">1.19953</td>
<td align="right">1.17907</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="estimator-functions" class="section level2">
<h2 class="hasAnchor">
<a href="#estimator-functions" class="anchor"></a>Estimator functions</h2>
<p>The parameters <code>fun</code> and <code>var</code> in <code><a href="../reference/calc.stError.html">calc.stError()</a></code> define the estimator to be used in the error analysis. There are two built-in estimator functions <code><a href="../reference/PointEstimates.html">weightedSum()</a></code> and <code><a href="../reference/PointEstimates.html">weightedRatio()</a></code> which can be used as follows.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">povertyRate &lt;-<span class="st"> </span><span class="kw"><a href="../reference/calc.stError.html">calc.stError</a></span>(dat_boot_calib, <span class="dt">var =</span> <span class="st">"povertyRisk"</span>, <span class="dt">fun =</span> weightedRatio, <span class="dt">period.mean =</span> <span class="ot">NULL</span>)
totalIncome &lt;-<span class="st"> </span><span class="kw"><a href="../reference/calc.stError.html">calc.stError</a></span>(dat_boot_calib, <span class="dt">var =</span> <span class="st">"eqIncome"</span>, <span class="dt">fun =</span> weightedSum, <span class="dt">period.mean =</span> <span class="ot">NULL</span>)</code></pre></div>
<p>Those functions calculate the ratio of persons at risk of povery (in percent) and the total income. By default, the results are calculated seperately for each reference period</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">povertyRate<span class="op">$</span>Estimates</code></pre></div>
<div class="kable-table">
<table class="table">
<thead><tr class="header">
<th align="right">year</th>
<th align="right">n</th>
<th align="right">N</th>
<th align="right">val_povertyRisk</th>
<th align="right">stE_povertyRisk</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">2010</td>
<td align="right">14827</td>
<td align="right">8182222</td>
<td align="right">14.44422</td>
<td align="right">0.4688685</td>
</tr>
<tr class="even">
<td align="right">2011</td>
<td align="right">14827</td>
<td align="right">8182222</td>
<td align="right">14.60155</td>
<td align="right">0.4024223</td>
</tr>
<tr class="odd">
<td align="right">2012</td>
<td align="right">14827</td>
<td align="right">8182222</td>
<td align="right">15.24983</td>
<td align="right">0.4220349</td>
</tr>
<tr class="even">
<td align="right">2013</td>
<td align="right">14827</td>
<td align="right">8182222</td>
<td align="right">15.60219</td>
<td align="right">0.4683628</td>
</tr>
<tr class="odd">
<td align="right">2014</td>
<td align="right">14827</td>
<td align="right">8182222</td>
<td align="right">15.57112</td>
<td align="right">0.4106918</td>
</tr>
<tr class="even">
<td align="right">2015</td>
<td align="right">14827</td>
<td align="right">8182222</td>
<td align="right">15.59373</td>
<td align="right">0.2814149</td>
</tr>
<tr class="odd">
<td align="right">2016</td>
<td align="right">14827</td>
<td align="right">8182222</td>
<td align="right">15.69460</td>
<td align="right">0.3654845</td>
</tr>
<tr class="even">
<td align="right">2017</td>
<td align="right">14827</td>
<td align="right">8182222</td>
<td align="right">15.81567</td>
<td align="right">0.2807620</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">totalIncome<span class="op">$</span>Estimates</code></pre></div>
<div class="kable-table">
<table class="table">
<thead><tr class="header">
<th align="right">year</th>
<th align="right">n</th>
<th align="right">N</th>
<th align="right">val_eqIncome</th>
<th align="right">stE_eqIncome</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">2010</td>
<td align="right">14827</td>
<td align="right">8182222</td>
<td align="right">162750998071</td>
<td align="right">1029103512</td>
</tr>
<tr class="even">
<td align="right">2011</td>
<td align="right">14827</td>
<td align="right">8182222</td>
<td align="right">162666081825</td>
<td align="right">961081325</td>
</tr>
<tr class="odd">
<td align="right">2012</td>
<td align="right">14827</td>
<td align="right">8182222</td>
<td align="right">162660101233</td>
<td align="right">786209364</td>
</tr>
<tr class="even">
<td align="right">2013</td>
<td align="right">14827</td>
<td align="right">8182222</td>
<td align="right">163219300922</td>
<td align="right">735151514</td>
</tr>
<tr class="odd">
<td align="right">2014</td>
<td align="right">14827</td>
<td align="right">8182222</td>
<td align="right">162880189131</td>
<td align="right">940438447</td>
</tr>
<tr class="even">
<td align="right">2015</td>
<td align="right">14827</td>
<td align="right">8182222</td>
<td align="right">162944348190</td>
<td align="right">721392480</td>
</tr>
<tr class="odd">
<td align="right">2016</td>
<td align="right">14827</td>
<td align="right">8182222</td>
<td align="right">164427022796</td>
<td align="right">1157406972</td>
</tr>
<tr class="even">
<td align="right">2017</td>
<td align="right">14827</td>
<td align="right">8182222</td>
<td align="right">163913627246</td>
<td align="right">1140647881</td>
</tr>
</tbody>
</table>
</div>
<p>Columns that use the <code>val_</code> prefix denote the point estimate belonging to the “main weight” of the dataset, which is <code>pWeight</code> in case of the dataset used here.</p>
<p>Columns with the <code>stE_</code> prefix denote standard errors calculated with bootstrap replicates. The replicates result in using <code>w1</code>, <code>w2</code>, …, <code>w10</code> instead of <code>pWeight</code> when applying the estimator.</p>
<p><code>n</code> and denotes the number of observations for the year and <code>N</code> denotes the total weight of those persons.</p>
<div id="custom-estimators" class="section level3">
<h3 class="hasAnchor">
<a href="#custom-estimators" class="anchor"></a>Custom estimators</h3>
<p>In order to define a custom estimator function to be used in <code>fun</code>, the function needs to have two arguments like the example below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## define custom estimator
myWeightedSum &lt;-<span class="st"> </span><span class="cf">function</span>(x, w) {
  <span class="kw">sum</span>(x<span class="op">*</span>w)
}

## check if results are equal to the one using `suveysd::weightedSum()`
totalIncome2 &lt;-<span class="st"> </span>totalIncome &lt;-<span class="st"> </span><span class="kw"><a href="../reference/calc.stError.html">calc.stError</a></span>(dat_boot_calib, <span class="dt">var =</span> <span class="st">"eqIncome"</span>, <span class="dt">fun =</span> weightedSum, 
                                            <span class="dt">period.mean =</span> <span class="ot">NULL</span>)
<span class="kw">all.equal</span>(totalIncome, totalIncome2)</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>The parameters <code>x</code> and <code>w</code> can be assumed to be vectors with equal length with <code>w</code> being numeric and <code>x</code> being the column defined in the <code>var</code> argument. It will be called once for each period (in this case <code>year</code>) and for each weight column (in this case <code>pWeight</code>, <code>w1</code>, <code>w2</code>, …, <code>w10</code>)</p>
</div>
<div id="multiple-estimators" class="section level3">
<h3 class="hasAnchor">
<a href="#multiple-estimators" class="anchor"></a>Multiple estimators</h3>
<p>In case an estimator should be applied to several columns of the dataset, <code>var</code> can be set to a vector containing all necessary columns.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">multipleRates &lt;-<span class="st"> </span><span class="kw"><a href="../reference/calc.stError.html">calc.stError</a></span>(dat_boot_calib, <span class="dt">var =</span> <span class="kw">c</span>(<span class="st">"povertyRisk"</span>, <span class="st">"onePerson"</span>), <span class="dt">fun =</span> weightedRatio, 
                              <span class="dt">period.mean =</span> <span class="ot">NULL</span>)
multipleRates<span class="op">$</span>Estimates</code></pre></div>
<div class="kable-table">
<table class="table">
<thead><tr class="header">
<th align="right">year</th>
<th align="right">n</th>
<th align="right">N</th>
<th align="right">val_povertyRisk</th>
<th align="right">stE_povertyRisk</th>
<th align="right">val_onePerson</th>
<th align="right">stE_onePerson</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">2010</td>
<td align="right">14827</td>
<td align="right">8182222</td>
<td align="right">14.44422</td>
<td align="right">0.4688685</td>
<td align="right">14.85737</td>
<td align="right">0.4608975</td>
</tr>
<tr class="even">
<td align="right">2011</td>
<td align="right">14827</td>
<td align="right">8182222</td>
<td align="right">14.60155</td>
<td align="right">0.4024223</td>
<td align="right">14.85737</td>
<td align="right">0.4204098</td>
</tr>
<tr class="odd">
<td align="right">2012</td>
<td align="right">14827</td>
<td align="right">8182222</td>
<td align="right">15.24983</td>
<td align="right">0.4220349</td>
<td align="right">14.85737</td>
<td align="right">0.4487607</td>
</tr>
<tr class="even">
<td align="right">2013</td>
<td align="right">14827</td>
<td align="right">8182222</td>
<td align="right">15.60219</td>
<td align="right">0.4683628</td>
<td align="right">14.85737</td>
<td align="right">0.3993618</td>
</tr>
<tr class="odd">
<td align="right">2014</td>
<td align="right">14827</td>
<td align="right">8182222</td>
<td align="right">15.57112</td>
<td align="right">0.4106918</td>
<td align="right">14.85737</td>
<td align="right">0.3364885</td>
</tr>
<tr class="even">
<td align="right">2015</td>
<td align="right">14827</td>
<td align="right">8182222</td>
<td align="right">15.59373</td>
<td align="right">0.2814149</td>
<td align="right">14.85737</td>
<td align="right">0.2616768</td>
</tr>
<tr class="odd">
<td align="right">2016</td>
<td align="right">14827</td>
<td align="right">8182222</td>
<td align="right">15.69460</td>
<td align="right">0.3654845</td>
<td align="right">14.85737</td>
<td align="right">0.1749362</td>
</tr>
<tr class="even">
<td align="right">2017</td>
<td align="right">14827</td>
<td align="right">8182222</td>
<td align="right">15.81567</td>
<td align="right">0.2807620</td>
<td align="right">14.85737</td>
<td align="right">0.2631210</td>
</tr>
</tbody>
</table>
</div>
<p>Here we see the relative number of persons at risk of poverty and the relative number of one-person households.</p>
</div>
</div>
<div id="grouping" class="section level2">
<h2 class="hasAnchor">
<a href="#grouping" class="anchor"></a>Grouping</h2>
<p>The <code>groups</code> argument can be used to calculate estimators for different subsets of the data. This argument can take the grouping variable as a string that refers to a column name (usually a factor) in <code>dat</code>. If set, all estimators are not only split by the reference period but also by the grouping variable. For simplicity, only one reference period of the above data is used.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat2 &lt;-<span class="st"> </span><span class="kw">subset</span>(dat_boot_calib, year <span class="op">==</span><span class="st"> </span><span class="dv">2010</span>)
<span class="cf">for</span> (att  <span class="cf">in</span> <span class="kw">c</span>(<span class="st">"period"</span>, <span class="st">"weights"</span>, <span class="st">"b.rep"</span>))
  <span class="kw">attr</span>(dat2, att) &lt;-<span class="st"> </span><span class="kw">attr</span>(dat_boot_calib, att)</code></pre></div>
<p>To calculate the ratio of persons at risk of poverty for each federal state of austria, <code>group = "region"</code> can be used.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">povertyRates &lt;-<span class="st"> </span><span class="kw"><a href="../reference/calc.stError.html">calc.stError</a></span>(dat2, <span class="dt">var =</span> <span class="st">"povertyRisk"</span>, <span class="dt">fun =</span> weightedRatio, <span class="dt">period.mean =</span> <span class="ot">NULL</span>,
                             <span class="dt">group =</span> <span class="st">"region"</span>)
povertyRates<span class="op">$</span>Estimates</code></pre></div>
<div class="kable-table">
<table class="table">
<thead><tr class="header">
<th align="right">year</th>
<th align="right">n</th>
<th align="right">N</th>
<th align="left">region</th>
<th align="right">val_povertyRisk</th>
<th align="right">stE_povertyRisk</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">2010</td>
<td align="right">549</td>
<td align="right">260564</td>
<td align="left">Burgenland</td>
<td align="right">19.53984</td>
<td align="right">3.0529974</td>
</tr>
<tr class="even">
<td align="right">2010</td>
<td align="right">733</td>
<td align="right">377355</td>
<td align="left">Vorarlberg</td>
<td align="right">16.53731</td>
<td align="right">2.6190864</td>
</tr>
<tr class="odd">
<td align="right">2010</td>
<td align="right">924</td>
<td align="right">535451</td>
<td align="left">Salzburg</td>
<td align="right">13.78734</td>
<td align="right">0.8154710</td>
</tr>
<tr class="even">
<td align="right">2010</td>
<td align="right">1078</td>
<td align="right">563648</td>
<td align="left">Carinthia</td>
<td align="right">13.08627</td>
<td align="right">0.8655090</td>
</tr>
<tr class="odd">
<td align="right">2010</td>
<td align="right">1317</td>
<td align="right">701899</td>
<td align="left">Tyrol</td>
<td align="right">15.30819</td>
<td align="right">1.5753152</td>
</tr>
<tr class="even">
<td align="right">2010</td>
<td align="right">2295</td>
<td align="right">1167045</td>
<td align="left">Styria</td>
<td align="right">14.37464</td>
<td align="right">0.7958432</td>
</tr>
<tr class="odd">
<td align="right">2010</td>
<td align="right">2322</td>
<td align="right">1598931</td>
<td align="left">Vienna</td>
<td align="right">17.23468</td>
<td align="right">1.8651747</td>
</tr>
<tr class="even">
<td align="right">2010</td>
<td align="right">2804</td>
<td align="right">1555709</td>
<td align="left">Lower Austria</td>
<td align="right">13.84362</td>
<td align="right">0.7735313</td>
</tr>
<tr class="odd">
<td align="right">2010</td>
<td align="right">2805</td>
<td align="right">1421620</td>
<td align="left">Upper Austria</td>
<td align="right">10.88977</td>
<td align="right">0.8575537</td>
</tr>
<tr class="even">
<td align="right">2010</td>
<td align="right">14827</td>
<td align="right">8182222</td>
<td align="left">NA</td>
<td align="right">14.44422</td>
<td align="right">0.4688685</td>
</tr>
</tbody>
</table>
</div>
<p>The last column with <code>region = NA</code> denotes the aggregate over all regions. Note that the columns <code>N</code> and <code>n</code> now show the weighted and unweighted number of persons in each region.</p>
<div id="several-grouping-variables" class="section level3">
<h3 class="hasAnchor">
<a href="#several-grouping-variables" class="anchor"></a>Several grouping variables</h3>
<p>In case more than one grouping variable is used, there are several options of calling <code><a href="../reference/calc.stError.html">calc.stError()</a></code> depending on whether combinations of grouping levels should be regarded or not. We will consider the variables <code>gender</code> and <code>region</code> as our grouping variables and show three options on how <code><a href="../reference/calc.stError.html">calc.stError()</a></code> can be called.</p>
<div id="option-1-all-regions-and-all-genders" class="section level4">
<h4 class="hasAnchor">
<a href="#option-1-all-regions-and-all-genders" class="anchor"></a>Option 1: All regions and all genders</h4>
<p>Calculate the point estimate and standard error for each region and each gender. The number of rows in the output is therefore</p>
<p><span class="math display">\[n_\text{periods}\cdot(n_\text{regions} + n_\text{genders} + 1) = 1\cdot(9 + 2 + 1) = 12.\]</span></p>
<p>The last row is again the estimate for the whole period.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">povertyRates &lt;-<span class="st"> </span><span class="kw"><a href="../reference/calc.stError.html">calc.stError</a></span>(dat2, <span class="dt">var =</span> <span class="st">"povertyRisk"</span>, <span class="dt">fun =</span> weightedRatio, <span class="dt">period.mean =</span> <span class="ot">NULL</span>,
                             <span class="dt">group =</span> <span class="kw">c</span>(<span class="st">"gender"</span>, <span class="st">"region"</span>))
povertyRates<span class="op">$</span>Estimates</code></pre></div>
<div class="kable-table">
<table class="table">
<thead><tr class="header">
<th align="right">year</th>
<th align="right">n</th>
<th align="right">N</th>
<th align="left">gender</th>
<th align="left">region</th>
<th align="right">val_povertyRisk</th>
<th align="right">stE_povertyRisk</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">2010</td>
<td align="right">549</td>
<td align="right">260564</td>
<td align="left">NA</td>
<td align="left">Burgenland</td>
<td align="right">19.53984</td>
<td align="right">3.0529974</td>
</tr>
<tr class="even">
<td align="right">2010</td>
<td align="right">733</td>
<td align="right">377355</td>
<td align="left">NA</td>
<td align="left">Vorarlberg</td>
<td align="right">16.53731</td>
<td align="right">2.6190864</td>
</tr>
<tr class="odd">
<td align="right">2010</td>
<td align="right">924</td>
<td align="right">535451</td>
<td align="left">NA</td>
<td align="left">Salzburg</td>
<td align="right">13.78734</td>
<td align="right">0.8154710</td>
</tr>
<tr class="even">
<td align="right">2010</td>
<td align="right">1078</td>
<td align="right">563648</td>
<td align="left">NA</td>
<td align="left">Carinthia</td>
<td align="right">13.08627</td>
<td align="right">0.8655090</td>
</tr>
<tr class="odd">
<td align="right">2010</td>
<td align="right">1317</td>
<td align="right">701899</td>
<td align="left">NA</td>
<td align="left">Tyrol</td>
<td align="right">15.30819</td>
<td align="right">1.5753152</td>
</tr>
<tr class="even">
<td align="right">2010</td>
<td align="right">2295</td>
<td align="right">1167045</td>
<td align="left">NA</td>
<td align="left">Styria</td>
<td align="right">14.37464</td>
<td align="right">0.7958432</td>
</tr>
<tr class="odd">
<td align="right">2010</td>
<td align="right">2322</td>
<td align="right">1598931</td>
<td align="left">NA</td>
<td align="left">Vienna</td>
<td align="right">17.23468</td>
<td align="right">1.8651747</td>
</tr>
<tr class="even">
<td align="right">2010</td>
<td align="right">2804</td>
<td align="right">1555709</td>
<td align="left">NA</td>
<td align="left">Lower Austria</td>
<td align="right">13.84362</td>
<td align="right">0.7735313</td>
</tr>
<tr class="odd">
<td align="right">2010</td>
<td align="right">2805</td>
<td align="right">1421620</td>
<td align="left">NA</td>
<td align="left">Upper Austria</td>
<td align="right">10.88977</td>
<td align="right">0.8575537</td>
</tr>
<tr class="even">
<td align="right">2010</td>
<td align="right">7267</td>
<td align="right">3979572</td>
<td align="left">male</td>
<td align="left">NA</td>
<td align="right">12.02660</td>
<td align="right">0.5997306</td>
</tr>
<tr class="odd">
<td align="right">2010</td>
<td align="right">7560</td>
<td align="right">4202650</td>
<td align="left">female</td>
<td align="left">NA</td>
<td align="right">16.73351</td>
<td align="right">0.4032427</td>
</tr>
<tr class="even">
<td align="right">2010</td>
<td align="right">14827</td>
<td align="right">8182222</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="right">14.44422</td>
<td align="right">0.4688685</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="option-2-all-combinations-of-state-and-gender" class="section level4">
<h4 class="hasAnchor">
<a href="#option-2-all-combinations-of-state-and-gender" class="anchor"></a>Option 2: All combinations of <code>state</code> and <code>gender</code>
</h4>
<p>Split the data by all cobinations of the two grouping variables. This will result in a larger output-table of the size</p>
<p><span class="math display">\[n_\text{periods}\cdot(n_\text{regions} \cdot n_\text{genders} + 1) = 1\cdot(9\cdot2 + 1)= 19.\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">povertyRates &lt;-<span class="st"> </span><span class="kw"><a href="../reference/calc.stError.html">calc.stError</a></span>(dat2, <span class="dt">var =</span> <span class="st">"povertyRisk"</span>, <span class="dt">fun =</span> weightedRatio, <span class="dt">period.mean =</span> <span class="ot">NULL</span>,
                             <span class="dt">group =</span> <span class="kw">list</span>(<span class="kw">c</span>(<span class="st">"gender"</span>, <span class="st">"region"</span>)))
povertyRates<span class="op">$</span>Estimates</code></pre></div>
<div class="kable-table">
<table class="table">
<thead><tr class="header">
<th align="right">year</th>
<th align="right">n</th>
<th align="right">N</th>
<th align="left">gender</th>
<th align="left">region</th>
<th align="right">val_povertyRisk</th>
<th align="right">stE_povertyRisk</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">2010</td>
<td align="right">261</td>
<td align="right">122741.8</td>
<td align="left">male</td>
<td align="left">Burgenland</td>
<td align="right">17.414524</td>
<td align="right">3.2690518</td>
</tr>
<tr class="even">
<td align="right">2010</td>
<td align="right">288</td>
<td align="right">137822.2</td>
<td align="left">female</td>
<td align="left">Burgenland</td>
<td align="right">21.432598</td>
<td align="right">3.2269725</td>
</tr>
<tr class="odd">
<td align="right">2010</td>
<td align="right">359</td>
<td align="right">182732.9</td>
<td align="left">male</td>
<td align="left">Vorarlberg</td>
<td align="right">12.973259</td>
<td align="right">2.3054104</td>
</tr>
<tr class="even">
<td align="right">2010</td>
<td align="right">374</td>
<td align="right">194622.1</td>
<td align="left">female</td>
<td align="left">Vorarlberg</td>
<td align="right">19.883637</td>
<td align="right">3.3381588</td>
</tr>
<tr class="odd">
<td align="right">2010</td>
<td align="right">440</td>
<td align="right">253143.7</td>
<td align="left">male</td>
<td align="left">Salzburg</td>
<td align="right">9.156964</td>
<td align="right">0.7703249</td>
</tr>
<tr class="even">
<td align="right">2010</td>
<td align="right">484</td>
<td align="right">282307.3</td>
<td align="left">female</td>
<td align="left">Salzburg</td>
<td align="right">17.939382</td>
<td align="right">1.0459533</td>
</tr>
<tr class="odd">
<td align="right">2010</td>
<td align="right">517</td>
<td align="right">268581.4</td>
<td align="left">male</td>
<td align="left">Carinthia</td>
<td align="right">10.552148</td>
<td align="right">1.2273479</td>
</tr>
<tr class="even">
<td align="right">2010</td>
<td align="right">561</td>
<td align="right">295066.6</td>
<td align="left">female</td>
<td align="left">Carinthia</td>
<td align="right">15.392924</td>
<td align="right">1.1943011</td>
</tr>
<tr class="odd">
<td align="right">2010</td>
<td align="right">650</td>
<td align="right">339566.5</td>
<td align="left">male</td>
<td align="left">Tyrol</td>
<td align="right">12.857542</td>
<td align="right">1.6196821</td>
</tr>
<tr class="even">
<td align="right">2010</td>
<td align="right">667</td>
<td align="right">362332.5</td>
<td align="left">female</td>
<td align="left">Tyrol</td>
<td align="right">17.604861</td>
<td align="right">2.0827838</td>
</tr>
<tr class="odd">
<td align="right">2010</td>
<td align="right">1128</td>
<td align="right">571011.7</td>
<td align="left">male</td>
<td align="left">Styria</td>
<td align="right">11.671247</td>
<td align="right">1.1805175</td>
</tr>
<tr class="even">
<td align="right">2010</td>
<td align="right">1132</td>
<td align="right">774405.4</td>
<td align="left">male</td>
<td align="left">Vienna</td>
<td align="right">15.590616</td>
<td align="right">1.9620115</td>
</tr>
<tr class="odd">
<td align="right">2010</td>
<td align="right">1167</td>
<td align="right">596033.3</td>
<td align="left">female</td>
<td align="left">Styria</td>
<td align="right">16.964539</td>
<td align="right">0.8158820</td>
</tr>
<tr class="even">
<td align="right">2010</td>
<td align="right">1190</td>
<td align="right">824525.6</td>
<td align="left">female</td>
<td align="left">Vienna</td>
<td align="right">18.778813</td>
<td align="right">2.0026863</td>
</tr>
<tr class="odd">
<td align="right">2010</td>
<td align="right">1363</td>
<td align="right">684272.5</td>
<td align="left">male</td>
<td align="left">Upper Austria</td>
<td align="right">9.074690</td>
<td align="right">1.0035774</td>
</tr>
<tr class="even">
<td align="right">2010</td>
<td align="right">1387</td>
<td align="right">772593.2</td>
<td align="left">female</td>
<td align="left">Lower Austria</td>
<td align="right">16.372949</td>
<td align="right">0.9232083</td>
</tr>
<tr class="odd">
<td align="right">2010</td>
<td align="right">1417</td>
<td align="right">783115.8</td>
<td align="left">male</td>
<td align="left">Lower Austria</td>
<td align="right">11.348283</td>
<td align="right">0.9225737</td>
</tr>
<tr class="even">
<td align="right">2010</td>
<td align="right">1442</td>
<td align="right">737347.5</td>
<td align="left">female</td>
<td align="left">Upper Austria</td>
<td align="right">12.574205</td>
<td align="right">0.7551254</td>
</tr>
<tr class="odd">
<td align="right">2010</td>
<td align="right">14827</td>
<td align="right">8182222.0</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="right">14.444218</td>
<td align="right">0.4688685</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="option-3-cobination-of-option-1-and-option-2" class="section level4">
<h4 class="hasAnchor">
<a href="#option-3-cobination-of-option-1-and-option-2" class="anchor"></a>Option 3: Cobination of Option 1 and Option 2</h4>
<p>In this case, the estimates and standard errors are calculated for</p>
<ul>
<li>every gender,</li>
<li>every state and</li>
<li>every combination of state and gender.</li>
</ul>
<p>The number of rows in the output is therefore</p>
<p><span class="math display">\[n_\text{periods}\cdot(n_\text{regions} \cdot n_\text{genders} + n_\text{regions} + n_\text{genders} + 1) = 1\cdot(9\cdot2 + 9 + 2 + 1) = 30.\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">povertyRates &lt;-<span class="st"> </span><span class="kw"><a href="../reference/calc.stError.html">calc.stError</a></span>(dat2, <span class="dt">var =</span> <span class="st">"povertyRisk"</span>, <span class="dt">fun =</span> weightedRatio, <span class="dt">period.mean =</span> <span class="ot">NULL</span>,
                             <span class="dt">group =</span> <span class="kw">list</span>(<span class="st">"gender"</span>, <span class="st">"region"</span>, <span class="kw">c</span>(<span class="st">"gender"</span>, <span class="st">"region"</span>)))
povertyRates<span class="op">$</span>Estimates</code></pre></div>
<div class="kable-table">
<table class="table">
<thead><tr class="header">
<th align="right">year</th>
<th align="right">n</th>
<th align="right">N</th>
<th align="left">gender</th>
<th align="left">region</th>
<th align="right">val_povertyRisk</th>
<th align="right">stE_povertyRisk</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">2010</td>
<td align="right">261</td>
<td align="right">122741.8</td>
<td align="left">male</td>
<td align="left">Burgenland</td>
<td align="right">17.414524</td>
<td align="right">3.2690518</td>
</tr>
<tr class="even">
<td align="right">2010</td>
<td align="right">288</td>
<td align="right">137822.2</td>
<td align="left">female</td>
<td align="left">Burgenland</td>
<td align="right">21.432598</td>
<td align="right">3.2269725</td>
</tr>
<tr class="odd">
<td align="right">2010</td>
<td align="right">359</td>
<td align="right">182732.9</td>
<td align="left">male</td>
<td align="left">Vorarlberg</td>
<td align="right">12.973259</td>
<td align="right">2.3054104</td>
</tr>
<tr class="even">
<td align="right">2010</td>
<td align="right">374</td>
<td align="right">194622.1</td>
<td align="left">female</td>
<td align="left">Vorarlberg</td>
<td align="right">19.883637</td>
<td align="right">3.3381588</td>
</tr>
<tr class="odd">
<td align="right">2010</td>
<td align="right">440</td>
<td align="right">253143.7</td>
<td align="left">male</td>
<td align="left">Salzburg</td>
<td align="right">9.156964</td>
<td align="right">0.7703249</td>
</tr>
<tr class="even">
<td align="right">2010</td>
<td align="right">484</td>
<td align="right">282307.3</td>
<td align="left">female</td>
<td align="left">Salzburg</td>
<td align="right">17.939382</td>
<td align="right">1.0459533</td>
</tr>
<tr class="odd">
<td align="right">2010</td>
<td align="right">517</td>
<td align="right">268581.4</td>
<td align="left">male</td>
<td align="left">Carinthia</td>
<td align="right">10.552148</td>
<td align="right">1.2273479</td>
</tr>
<tr class="even">
<td align="right">2010</td>
<td align="right">549</td>
<td align="right">260564.0</td>
<td align="left">NA</td>
<td align="left">Burgenland</td>
<td align="right">19.539836</td>
<td align="right">3.0529974</td>
</tr>
<tr class="odd">
<td align="right">2010</td>
<td align="right">561</td>
<td align="right">295066.6</td>
<td align="left">female</td>
<td align="left">Carinthia</td>
<td align="right">15.392924</td>
<td align="right">1.1943011</td>
</tr>
<tr class="even">
<td align="right">2010</td>
<td align="right">650</td>
<td align="right">339566.5</td>
<td align="left">male</td>
<td align="left">Tyrol</td>
<td align="right">12.857542</td>
<td align="right">1.6196821</td>
</tr>
<tr class="odd">
<td align="right">2010</td>
<td align="right">667</td>
<td align="right">362332.5</td>
<td align="left">female</td>
<td align="left">Tyrol</td>
<td align="right">17.604861</td>
<td align="right">2.0827838</td>
</tr>
<tr class="even">
<td align="right">2010</td>
<td align="right">733</td>
<td align="right">377355.0</td>
<td align="left">NA</td>
<td align="left">Vorarlberg</td>
<td align="right">16.537310</td>
<td align="right">2.6190864</td>
</tr>
<tr class="odd">
<td align="right">2010</td>
<td align="right">924</td>
<td align="right">535451.0</td>
<td align="left">NA</td>
<td align="left">Salzburg</td>
<td align="right">13.787343</td>
<td align="right">0.8154710</td>
</tr>
<tr class="even">
<td align="right">2010</td>
<td align="right">1078</td>
<td align="right">563648.0</td>
<td align="left">NA</td>
<td align="left">Carinthia</td>
<td align="right">13.086268</td>
<td align="right">0.8655090</td>
</tr>
<tr class="odd">
<td align="right">2010</td>
<td align="right">1128</td>
<td align="right">571011.7</td>
<td align="left">male</td>
<td align="left">Styria</td>
<td align="right">11.671247</td>
<td align="right">1.1805175</td>
</tr>
<tr class="even">
<td align="right">2010</td>
<td align="right">1132</td>
<td align="right">774405.4</td>
<td align="left">male</td>
<td align="left">Vienna</td>
<td align="right">15.590616</td>
<td align="right">1.9620115</td>
</tr>
<tr class="odd">
<td align="right">2010</td>
<td align="right">1167</td>
<td align="right">596033.3</td>
<td align="left">female</td>
<td align="left">Styria</td>
<td align="right">16.964539</td>
<td align="right">0.8158820</td>
</tr>
<tr class="even">
<td align="right">2010</td>
<td align="right">1190</td>
<td align="right">824525.6</td>
<td align="left">female</td>
<td align="left">Vienna</td>
<td align="right">18.778813</td>
<td align="right">2.0026863</td>
</tr>
<tr class="odd">
<td align="right">2010</td>
<td align="right">1317</td>
<td align="right">701899.0</td>
<td align="left">NA</td>
<td align="left">Tyrol</td>
<td align="right">15.308191</td>
<td align="right">1.5753152</td>
</tr>
<tr class="even">
<td align="right">2010</td>
<td align="right">1363</td>
<td align="right">684272.5</td>
<td align="left">male</td>
<td align="left">Upper Austria</td>
<td align="right">9.074690</td>
<td align="right">1.0035774</td>
</tr>
<tr class="odd">
<td align="right">2010</td>
<td align="right">1387</td>
<td align="right">772593.2</td>
<td align="left">female</td>
<td align="left">Lower Austria</td>
<td align="right">16.372949</td>
<td align="right">0.9232083</td>
</tr>
<tr class="even">
<td align="right">2010</td>
<td align="right">1417</td>
<td align="right">783115.8</td>
<td align="left">male</td>
<td align="left">Lower Austria</td>
<td align="right">11.348283</td>
<td align="right">0.9225737</td>
</tr>
<tr class="odd">
<td align="right">2010</td>
<td align="right">1442</td>
<td align="right">737347.5</td>
<td align="left">female</td>
<td align="left">Upper Austria</td>
<td align="right">12.574205</td>
<td align="right">0.7551254</td>
</tr>
<tr class="even">
<td align="right">2010</td>
<td align="right">2295</td>
<td align="right">1167045.0</td>
<td align="left">NA</td>
<td align="left">Styria</td>
<td align="right">14.374637</td>
<td align="right">0.7958432</td>
</tr>
<tr class="odd">
<td align="right">2010</td>
<td align="right">2322</td>
<td align="right">1598931.0</td>
<td align="left">NA</td>
<td align="left">Vienna</td>
<td align="right">17.234683</td>
<td align="right">1.8651747</td>
</tr>
<tr class="even">
<td align="right">2010</td>
<td align="right">2804</td>
<td align="right">1555709.0</td>
<td align="left">NA</td>
<td align="left">Lower Austria</td>
<td align="right">13.843623</td>
<td align="right">0.7735313</td>
</tr>
<tr class="odd">
<td align="right">2010</td>
<td align="right">2805</td>
<td align="right">1421620.0</td>
<td align="left">NA</td>
<td align="left">Upper Austria</td>
<td align="right">10.889773</td>
<td align="right">0.8575537</td>
</tr>
<tr class="even">
<td align="right">2010</td>
<td align="right">7267</td>
<td align="right">3979571.7</td>
<td align="left">male</td>
<td align="left">NA</td>
<td align="right">12.026600</td>
<td align="right">0.5997306</td>
</tr>
<tr class="odd">
<td align="right">2010</td>
<td align="right">7560</td>
<td align="right">4202650.3</td>
<td align="left">female</td>
<td align="left">NA</td>
<td align="right">16.733508</td>
<td align="right">0.4032427</td>
</tr>
<tr class="even">
<td align="right">2010</td>
<td align="right">14827</td>
<td align="right">8182222.0</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="right">14.444218</td>
<td align="right">0.4688685</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#prerequisites">Prerequisites</a></li>
      <li>
<a href="#estimator-functions">Estimator functions</a><ul class="nav nav-pills nav-stacked">
<li><a href="#custom-estimators">Custom estimators</a></li>
      <li><a href="#multiple-estimators">Multiple estimators</a></li>
      </ul>
</li>
      <li>
<a href="#grouping">Grouping</a><ul class="nav nav-pills nav-stacked">
<li><a href="#several-grouping-variables">Several grouping variables</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Johannes Gussenbauer, Alexander Kowarik, Gregor de Cillia.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
