<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to surveysd â€¢ surveysd</title>
<link rel="shortcut icon" type="image/x-icon" href="../favicon.ico">
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to surveysd">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">surveysd</a>
        <span class="label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/surveysd.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/error_estimation.html">Error estimation</a>
    </li>
    <li>
      <a href="../articles/methodology.html">Methodology</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/statistikat/surveysd">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Introduction to surveysd</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/statistikat/surveysd/blob/master/vignettes/surveysd.Rmd"><code>vignettes/surveysd.Rmd</code></a></small>
      <div class="hidden name"><code>surveysd.Rmd</code></div>

    </div>

    
    
<p>The goal of surveysd is to combine all necessary steps to use calibrated bootstrapping with custom estimation functions. This vignette will cover the usage of the most important functions. For insights in the theory used in this package, refer to <code><a href="../articles/methodology.html">vignette("methodology")</a></code>.</p>
<div id="load-dummy-data" class="section level3">
<h3 class="hasAnchor">
<a href="#load-dummy-data" class="anchor"></a>Load dummy data</h3>
<p>A test data set based on <code>data(eusilc, package = "laeken")</code> can be created with <code><a href="../reference/demo.eusilc.html">demo.eusilc()</a></code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(surveysd)

<span class="kw">set.seed</span>(<span class="dv">1234</span>)
eusilc &lt;-<span class="st"> </span><span class="kw"><a href="../reference/demo.eusilc.html">demo.eusilc</a></span>(<span class="dt">n =</span> <span class="dv">2</span>, <span class="dt">prettyNames =</span> <span class="ot">TRUE</span>)

eusilc[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, .(year, povertyRisk, gender, pWeight)]</code></pre></div>
<div class="kable-table">
<table class="table">
<thead><tr class="header">
<th align="right">year</th>
<th align="left">povertyRisk</th>
<th align="left">gender</th>
<th align="right">pWeight</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">2010</td>
<td align="left">FALSE</td>
<td align="left">female</td>
<td align="right">504.5696</td>
</tr>
<tr class="even">
<td align="right">2010</td>
<td align="left">FALSE</td>
<td align="left">male</td>
<td align="right">504.5696</td>
</tr>
<tr class="odd">
<td align="right">2010</td>
<td align="left">FALSE</td>
<td align="left">male</td>
<td align="right">504.5696</td>
</tr>
<tr class="even">
<td align="right">2010</td>
<td align="left">FALSE</td>
<td align="left">female</td>
<td align="right">493.3824</td>
</tr>
<tr class="odd">
<td align="right">2010</td>
<td align="left">FALSE</td>
<td align="left">male</td>
<td align="right">493.3824</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="draw-bootstrap-replicates" class="section level3">
<h3 class="hasAnchor">
<a href="#draw-bootstrap-replicates" class="anchor"></a>Draw bootstrap replicates</h3>
<p>Use stratified resampling without replacement to generate 10 samples. Those samples are consistent with respect to the reference periods.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat_boot &lt;-<span class="st"> </span><span class="kw"><a href="../reference/draw.bootstrap.html">draw.bootstrap</a></span>(eusilc, <span class="dt">REP =</span> <span class="dv">10</span>, <span class="dt">hid =</span> <span class="st">"hid"</span>, <span class="dt">weights =</span> <span class="st">"pWeight"</span>, 
                           <span class="dt">strata =</span> <span class="st">"region"</span>, <span class="dt">period =</span> <span class="st">"year"</span>)</code></pre></div>
</div>
<div id="calibrate-bootstrap-replicates" class="section level3">
<h3 class="hasAnchor">
<a href="#calibrate-bootstrap-replicates" class="anchor"></a>Calibrate bootstrap replicates</h3>
<p>Calibrate each sample according to the distribution of <code>gender</code> (on a personal level) and <code>region</code> (on a household level).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat_boot_calib &lt;-<span class="st"> </span><span class="kw"><a href="../reference/recalib.html">recalib</a></span>(dat_boot, <span class="dt">conP.var =</span> <span class="st">"gender"</span>, <span class="dt">conH.var =</span> <span class="st">"region"</span>)</code></pre></div>
<pre><code>## Convergence reached in  1  steps 
## Convergence reached in  2  steps 
## Convergence reached in  1  steps 
## Convergence reached in  2  steps 
## Convergence reached in  2  steps 
## Convergence reached in  1  steps 
## Convergence reached in  3  steps 
## Convergence reached in  2  steps 
## Convergence reached in  2  steps 
## Convergence reached in  2  steps</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat_boot_calib[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, .(year, povertyRisk, gender, pWeight, w1, w2, w3, w4)]</code></pre></div>
<div class="kable-table">
<table class="table">
<thead><tr class="header">
<th align="right">year</th>
<th align="left">povertyRisk</th>
<th align="left">gender</th>
<th align="right">pWeight</th>
<th align="right">w1</th>
<th align="right">w2</th>
<th align="right">w3</th>
<th align="right">w4</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">2010</td>
<td align="left">FALSE</td>
<td align="left">female</td>
<td align="right">504.5696</td>
<td align="right">1007.77</td>
<td align="right">1.375227</td>
<td align="right">1007.77</td>
<td align="right">1021.5646</td>
</tr>
<tr class="even">
<td align="right">2010</td>
<td align="left">FALSE</td>
<td align="left">male</td>
<td align="right">504.5696</td>
<td align="right">1007.77</td>
<td align="right">1.375227</td>
<td align="right">1007.77</td>
<td align="right">1021.5646</td>
</tr>
<tr class="odd">
<td align="right">2010</td>
<td align="left">FALSE</td>
<td align="left">male</td>
<td align="right">504.5696</td>
<td align="right">1007.77</td>
<td align="right">1.375227</td>
<td align="right">1007.77</td>
<td align="right">1021.5646</td>
</tr>
<tr class="even">
<td align="right">2011</td>
<td align="left">FALSE</td>
<td align="left">female</td>
<td align="right">504.5696</td>
<td align="right">1007.77</td>
<td align="right">1.394112</td>
<td align="right">1007.77</td>
<td align="right">992.9215</td>
</tr>
<tr class="odd">
<td align="right">2011</td>
<td align="left">FALSE</td>
<td align="left">male</td>
<td align="right">504.5696</td>
<td align="right">1007.77</td>
<td align="right">1.394112</td>
<td align="right">1007.77</td>
<td align="right">992.9215</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="estimate-with-respect-to-a-grouping-variable" class="section level3">
<h3 class="hasAnchor">
<a href="#estimate-with-respect-to-a-grouping-variable" class="anchor"></a>Estimate with respect to a grouping variable</h3>
<p>Estimate relative amount of persons at risk of poverty per period and <code>gender</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">err.est &lt;-<span class="st"> </span><span class="kw"><a href="../reference/calc.stError.html">calc.stError</a></span>(dat_boot_calib, <span class="dt">var =</span> <span class="st">"povertyRisk"</span>, <span class="dt">fun =</span> weightedRatio,
                        <span class="dt">group =</span> <span class="st">"gender"</span>, <span class="dt">period.mean =</span> <span class="ot">NULL</span>)
err.est<span class="op">$</span>Estimates</code></pre></div>
<div class="kable-table">
<table class="table">
<thead><tr class="header">
<th align="right">year</th>
<th align="right">n</th>
<th align="right">N</th>
<th align="left">gender</th>
<th align="right">val_povertyRisk</th>
<th align="right">stE_povertyRisk</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">2010</td>
<td align="right">7267</td>
<td align="right">3979572</td>
<td align="left">male</td>
<td align="right">12.02660</td>
<td align="right">0.4787568</td>
</tr>
<tr class="even">
<td align="right">2010</td>
<td align="right">7560</td>
<td align="right">4202650</td>
<td align="left">female</td>
<td align="right">16.73351</td>
<td align="right">0.4804257</td>
</tr>
<tr class="odd">
<td align="right">2010</td>
<td align="right">14827</td>
<td align="right">8182222</td>
<td align="left">NA</td>
<td align="right">14.44422</td>
<td align="right">0.4280277</td>
</tr>
<tr class="even">
<td align="right">2011</td>
<td align="right">7267</td>
<td align="right">3979572</td>
<td align="left">male</td>
<td align="right">12.68746</td>
<td align="right">0.4393305</td>
</tr>
<tr class="odd">
<td align="right">2011</td>
<td align="right">7560</td>
<td align="right">4202650</td>
<td align="left">female</td>
<td align="right">16.41404</td>
<td align="right">0.5715623</td>
</tr>
<tr class="even">
<td align="right">2011</td>
<td align="right">14827</td>
<td align="right">8182222</td>
<td align="left">NA</td>
<td align="right">14.60155</td>
<td align="right">0.4325268</td>
</tr>
</tbody>
</table>
</div>
<p>The output contains estimates (<code>val_povertyRisk</code>) as well as standard errors (<code>stE_povertyRisk</code>) measured in percent.</p>
</div>
<div id="estimate-with-respect-to-several-variables" class="section level3">
<h3 class="hasAnchor">
<a href="#estimate-with-respect-to-several-variables" class="anchor"></a>Estimate with respect to several variables</h3>
<p>Estimate relative amount of persons at risk of poverty per period for each <code>region</code>, <code>gender</code>, and combination of both.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">group &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="st">"gender"</span>, <span class="st">"region"</span>, <span class="kw">c</span>(<span class="st">"gender"</span>, <span class="st">"region"</span>))
err.est &lt;-<span class="st"> </span><span class="kw"><a href="../reference/calc.stError.html">calc.stError</a></span>(dat_boot_calib, <span class="dt">var =</span> <span class="st">"povertyRisk"</span>, <span class="dt">fun =</span> weightedRatio,
                        <span class="dt">group =</span> group, <span class="dt">period.mean =</span> <span class="ot">NULL</span>)
<span class="kw">head</span>(err.est<span class="op">$</span>Estimates)</code></pre></div>
<div class="kable-table">
<table class="table">
<thead><tr class="header">
<th align="right">year</th>
<th align="right">n</th>
<th align="right">N</th>
<th align="left">gender</th>
<th align="left">region</th>
<th align="right">val_povertyRisk</th>
<th align="right">stE_povertyRisk</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">2010</td>
<td align="right">261</td>
<td align="right">122741.8</td>
<td align="left">male</td>
<td align="left">Burgenland</td>
<td align="right">17.414524</td>
<td align="right">3.996392</td>
</tr>
<tr class="even">
<td align="right">2010</td>
<td align="right">288</td>
<td align="right">137822.2</td>
<td align="left">female</td>
<td align="left">Burgenland</td>
<td align="right">21.432598</td>
<td align="right">3.750117</td>
</tr>
<tr class="odd">
<td align="right">2010</td>
<td align="right">359</td>
<td align="right">182732.9</td>
<td align="left">male</td>
<td align="left">Vorarlberg</td>
<td align="right">12.973259</td>
<td align="right">3.790237</td>
</tr>
<tr class="even">
<td align="right">2010</td>
<td align="right">374</td>
<td align="right">194622.1</td>
<td align="left">female</td>
<td align="left">Vorarlberg</td>
<td align="right">19.883637</td>
<td align="right">3.662933</td>
</tr>
<tr class="odd">
<td align="right">2010</td>
<td align="right">440</td>
<td align="right">253143.7</td>
<td align="left">male</td>
<td align="left">Salzburg</td>
<td align="right">9.156964</td>
<td align="right">1.350321</td>
</tr>
<tr class="even">
<td align="right">2010</td>
<td align="right">484</td>
<td align="right">282307.3</td>
<td align="left">female</td>
<td align="left">Salzburg</td>
<td align="right">17.939382</td>
<td align="right">2.627855</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## skipping 54 more rows</code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Johannes Gussenbauer, Alexander Kowarik, Gregor de Cillia.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
