<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to surveysd â€¢ surveysd</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to surveysd">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">surveysd</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/surveysd.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/error_estimation.html">Error estimation</a>
    </li>
    <li>
      <a href="../articles/methodology.html">Methodology</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/statistikat/surveysd">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Introduction to surveysd</h1>
            
            <h4 class="date">2019-01-18</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/statistikat/surveysd/blob/master/vignettes/surveysd.Rmd"><code>vignettes/surveysd.Rmd</code></a></small>
      <div class="hidden name"><code>surveysd.Rmd</code></div>

    </div>

    
    
<p>The goal of surveysd is to combine all necessary steps to use calibrated bootstrapping with custom estimation functions. This vignette will cover the usage of the most important functions. For insights in the theory used in this package, refer to <code><a href="../articles/methodology.html">vignette("methodology")</a></code>.</p>
<div id="load-dummy-data" class="section level3">
<h3 class="hasAnchor">
<a href="#load-dummy-data" class="anchor"></a>Load dummy data</h3>
<p>A test data set based on <code><a href="https://www.rdocumentation.org/packages/utils/topics/data">data(eusilc, package = "laeken")</a></code> can be created with <code><a href="../reference/demo.eusilc.html">demo.eusilc()</a></code></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(surveysd)</a>
<a class="sourceLine" id="cb1-2" title="2"></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb1-4" title="4">eusilc &lt;-<span class="st"> </span><span class="kw"><a href="../reference/demo.eusilc.html">demo.eusilc</a></span>(<span class="dt">n =</span> <span class="dv">2</span>, <span class="dt">prettyNames =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb1-5" title="5"></a>
<a class="sourceLine" id="cb1-6" title="6">eusilc[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, .(year, povertyRisk, gender, pWeight)]</a></code></pre></div>
<pre><code>##    year povertyRisk gender  pWeight
## 1: 2010       FALSE female 504.5696
## 2: 2010       FALSE   male 504.5696
## 3: 2010       FALSE   male 504.5696
## 4: 2010       FALSE female 493.3824
## 5: 2010       FALSE   male 493.3824</code></pre>
</div>
<div id="draw-bootstrap-replicates" class="section level3">
<h3 class="hasAnchor">
<a href="#draw-bootstrap-replicates" class="anchor"></a>Draw bootstrap replicates</h3>
<p>Use stratified resampling without replacement to generate 10 samples. Those samples are consistent with respect to the reference periods.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">dat_boot &lt;-<span class="st"> </span><span class="kw"><a href="../reference/draw.bootstrap.html">draw.bootstrap</a></span>(eusilc, <span class="dt">REP =</span> <span class="dv">10</span>, <span class="dt">hid =</span> <span class="st">"hid"</span>, <span class="dt">weights =</span> <span class="st">"pWeight"</span>, </a>
<a class="sourceLine" id="cb3-2" title="2">                           <span class="dt">strata =</span> <span class="st">"region"</span>, <span class="dt">period =</span> <span class="st">"year"</span>)</a></code></pre></div>
</div>
<div id="calibrate-bootstrap-replicates" class="section level3">
<h3 class="hasAnchor">
<a href="#calibrate-bootstrap-replicates" class="anchor"></a>Calibrate bootstrap replicates</h3>
<p>Calibrate each sample according to the distribution of <code>gender</code> (on a personal level) and <code>region</code> (on a household level).</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">dat_boot_calib &lt;-<span class="st"> </span><span class="kw"><a href="../reference/recalib.html">recalib</a></span>(dat_boot, <span class="dt">conP.var =</span> <span class="st">"gender"</span>, <span class="dt">conH.var =</span> <span class="st">"region"</span>)</a></code></pre></div>
<pre><code>## Convergence reached in 1 steps</code></pre>
<pre><code>## Convergence reached in 2 steps</code></pre>
<pre><code>## Convergence reached in 1 steps</code></pre>
<pre><code>## Convergence reached in 2 steps 
## 
## Convergence reached in 2 steps</code></pre>
<pre><code>## Convergence reached in 1 steps</code></pre>
<pre><code>## Convergence reached in 3 steps</code></pre>
<pre><code>## Convergence reached in 2 steps 
## 
## Convergence reached in 2 steps 
## 
## Convergence reached in 2 steps</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">dat_boot_calib[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, .(year, povertyRisk, gender, pWeight, w1, w2, w3, w4)]</a></code></pre></div>
<pre><code>##    year povertyRisk gender  pWeight      w1       w2      w3        w4
## 1: 2010       FALSE female 504.5696 1007.77 1.375227 1007.77 1021.5646
## 2: 2010       FALSE   male 504.5696 1007.77 1.375227 1007.77 1021.5646
## 3: 2010       FALSE   male 504.5696 1007.77 1.375227 1007.77 1021.5646
## 4: 2011       FALSE female 504.5696 1007.77 1.394112 1007.77  992.9215
## 5: 2011       FALSE   male 504.5696 1007.77 1.394112 1007.77  992.9215</code></pre>
</div>
<div id="estimate-with-respect-to-a-grouping-variable" class="section level3">
<h3 class="hasAnchor">
<a href="#estimate-with-respect-to-a-grouping-variable" class="anchor"></a>Estimate with respect to a grouping variable</h3>
<p>Estimate relative amount of persons at risk of poverty per period and <code>gender</code>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">err.est &lt;-<span class="st"> </span><span class="kw"><a href="../reference/calc.stError.html">calc.stError</a></span>(dat_boot_calib, <span class="dt">var =</span> <span class="st">"povertyRisk"</span>, <span class="dt">fun =</span> weightedRatio, <span class="dt">group =</span> <span class="st">"gender"</span>)</a>
<a class="sourceLine" id="cb14-2" title="2">err.est<span class="op">$</span>Estimates</a></code></pre></div>
<pre><code>##    year     n       N gender val_povertyRisk stE_povertyRisk
## 1: 2010  7267 3979572   male        12.02660       0.4787568
## 2: 2010  7560 4202650 female        16.73351       0.4804257
## 3: 2010 14827 8182222   &lt;NA&gt;        14.44422       0.4280277
## 4: 2011  7267 3979572   male        12.68746       0.4393305
## 5: 2011  7560 4202650 female        16.41404       0.5715623
## 6: 2011 14827 8182222   &lt;NA&gt;        14.60155       0.4325268</code></pre>
<p>The output contains estimates (<code>val_povertyRisk</code>) as well as standard errors (<code>stE_povertyRisk</code>) measured in percent.</p>
</div>
<div id="estimate-with-respect-to-several-variables" class="section level3">
<h3 class="hasAnchor">
<a href="#estimate-with-respect-to-several-variables" class="anchor"></a>Estimate with respect to several variables</h3>
<p>Estimate relative amount of persons at risk of poverty per period for each <code>region</code>, <code>gender</code>, and combination of both.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">group &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="st">"gender"</span>, <span class="st">"region"</span>, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"gender"</span>, <span class="st">"region"</span>))</a>
<a class="sourceLine" id="cb16-2" title="2">err.est &lt;-<span class="st"> </span><span class="kw"><a href="../reference/calc.stError.html">calc.stError</a></span>(dat_boot_calib, <span class="dt">var =</span> <span class="st">"povertyRisk"</span>, <span class="dt">fun =</span> weightedRatio, <span class="dt">group =</span> group)</a>
<a class="sourceLine" id="cb16-3" title="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(err.est<span class="op">$</span>Estimates)</a></code></pre></div>
<pre><code>##    year   n        N gender     region val_povertyRisk stE_povertyRisk
## 1: 2010 261 122741.8   male Burgenland       17.414524        3.996392
## 2: 2010 288 137822.2 female Burgenland       21.432598        3.750117
## 3: 2010 359 182732.9   male Vorarlberg       12.973259        3.790237
## 4: 2010 374 194622.1 female Vorarlberg       19.883637        3.662933
## 5: 2010 440 253143.7   male   Salzburg        9.156964        1.350321
## 6: 2010 484 282307.3 female   Salzburg       17.939382        2.627855</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="co">## skipping 54 more rows</span></a></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Johannes Gussenbauer, Alexander Kowarik, Gregor de Cillia.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.9000.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
