<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Calcualte point estimates and their standard errors using bootstrap
weights. — calc.stError • surveysd</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />
<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  
<meta property="og:title" content="Calcualte point estimates and their standard errors using bootstrap
weights. — calc.stError" />

<meta property="og:description" content="Calculate point estimates as well as standard errors of variables in surveys.
Standard errors are estimated using bootstrap weights (see draw.bootstrap
and recalib). In addition the standard error of an estimate can be
calcualted using the survey data for 3 or more consecutive periods, which
results in a reduction of the standard error." />

<meta property="og:image" content="/logo.png" />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">surveysd</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/surveysd.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/error_estimation.html">Error estimation</a>
    </li>
    <li>
      <a href="../articles/methodology.html">Methodology</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/statistikat/surveysd">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calcualte point estimates and their standard errors using bootstrap
weights.</h1>
    <small class="dont-index">Source: <a href='https://github.com/statistikat/surveysd/blob/master/R/calc.stError.R'><code>R/calc.stError.R</code></a></small>
    <div class="hidden name"><code>calc.stError.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Calculate point estimates as well as standard errors of variables in surveys.
Standard errors are estimated using bootstrap weights (see <a href='draw.bootstrap.html'>draw.bootstrap</a>
and <a href='recalib.html'>recalib</a>). In addition the standard error of an estimate can be
calcualted using the survey data for 3 or more consecutive periods, which
results in a reduction of the standard error.</p>
    
    </div>

    <pre class="usage"><span class='fu'>calc.stError</span>(<span class='no'>dat</span>, <span class='kw'>weights</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/attr.html'>attr</a></span>(<span class='no'>dat</span>, <span class='st'>"weights"</span>), <span class='kw'>b.weights</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/attr.html'>attr</a></span>(<span class='no'>dat</span>,
  <span class='st'>"b.rep"</span>), <span class='kw'>period</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/attr.html'>attr</a></span>(<span class='no'>dat</span>, <span class='st'>"period"</span>), <span class='no'>var</span>, <span class='kw'>fun</span> <span class='kw'>=</span> <span class='no'>weightedRatio</span>,
  <span class='kw'>national</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>group</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>fun.adjust.var</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>adjust.var</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>period.diff</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>period.mean</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>bias</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>size.limit</span> <span class='kw'>=</span> <span class='fl'>20</span>, <span class='kw'>cv.limit</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>p</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>add.arg</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>dat</th>
      <td><p>either data.frame or data.table containing the survey data.
Surveys can be a panel survey or rotating panel survey, but does not need
to be. For rotating panel survey bootstrap weights can be created using
<a href='draw.bootstrap.html'>draw.bootstrap</a> and <a href='recalib.html'>recalib</a>.</p></td>
    </tr>
    <tr>
      <th>weights</th>
      <td><p>character specifying the name of the column in <code>dat</code>
containing the original sample weights. Used to calculate point estimates.</p></td>
    </tr>
    <tr>
      <th>b.weights</th>
      <td><p>character vector specifying the names of the columns in
<code>dat</code> containing bootstrap weights. Used to calculate standard errors.</p></td>
    </tr>
    <tr>
      <th>period</th>
      <td><p>character specifying the name of the column in <code>dat</code>
containing the sample periods.</p></td>
    </tr>
    <tr>
      <th>var</th>
      <td><p>character vector containing variable names in <code>dat</code> on which <code>fun</code>
shall be applied for each sample period.</p></td>
    </tr>
    <tr>
      <th>fun</th>
      <td><p>function which will be applied on <code>var</code> for each sample period.
Predefined functions are <a href='PointEstimates.html'>weightedRatio</a>, <a href='PointEstimates.html'>weightedSum</a>, but can also take
any other function which returns a double or integer and uses weights as
its second argument.</p></td>
    </tr>
    <tr>
      <th>national</th>
      <td><p>boolean, if TRUE point estimates resulting from fun will be
divided by the point estimate at the national level.</p></td>
    </tr>
    <tr>
      <th>group</th>
      <td><p>character vectors or list of character vectors containig
variables in <code>dat</code>. For each list entry <code>dat</code> will be split in subgroups
according to the containing variables as well as <code>period</code>. The
pointestimates are then estimated for each subgroup seperately. If
<code>group=NULL</code> the data will split into sample periods by default.</p></td>
    </tr>
    <tr>
      <th>fun.adjust.var</th>
      <td><p>can be either <code>NULL</code> or a function. This argument can
be used to apply a function for each <code>period</code> and bootstrap weight to the
data. The resulting estimates will be passed down to <code>fun</code>. See details for
more explanations.</p></td>
    </tr>
    <tr>
      <th>adjust.var</th>
      <td><p>can be either <code>NULL</code> or a character specifying the first
argument in <code>fun.adjust.var</code>.</p></td>
    </tr>
    <tr>
      <th>period.diff</th>
      <td><p>character vectors, defining periods for which the
differences in the point estimate as well it's standard error is
calculated. Each entry must have the form of <code>"period1 - period2"</code>. Can be
NULL</p></td>
    </tr>
    <tr>
      <th>period.mean</th>
      <td><p>odd integer, defining the range of periods over which the
sample mean of point estimates is additionally calcualted.</p></td>
    </tr>
    <tr>
      <th>bias</th>
      <td><p>boolean, if <code>TRUE</code> the sample mean over the point estimates of
the bootstrap weights is returned.</p></td>
    </tr>
    <tr>
      <th>size.limit</th>
      <td><p>integer defining a lower bound on the number of
observations on <code>dat</code> in each group defined by <code>period</code> and the entries in
<code>group</code>. Warnings are returned if the number of observations in a subgroup
falls below <code>size.limit</code>. In addition the concerned groups are available in
the function output.</p></td>
    </tr>
    <tr>
      <th>cv.limit</th>
      <td><p>non-negativ value defining a upper bound for the standard
error in relation to the point estimate. If this relation exceed
<code>cv.limit</code>, for a point estimate, they are flagged and available in the
function output.</p></td>
    </tr>
    <tr>
      <th>p</th>
      <td><p>numeric vector containing values between 0 and 1. Defines which
quantiles for the distribution of <code>var</code> are additionally estimated.</p></td>
    </tr>
    <tr>
      <th>add.arg</th>
      <td><p>additional arguments which will be passed to fun. Can be
either a named list or vector. The names of the object correspond to the
function arguments and the values to column names in dat, see also
examples.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Returns a list containing:</p><ul>
<li><p><code>Estimates</code>: data.table containing period differences and/or k period
averages for estimates of
<code>fun</code> applied to <code>var</code> as well as the corresponding standard errors, which
are calculated using the bootstrap weights. In addition the sample size,
<code>n</code>, and poplutaion size for each group is added to the output.</p></li>
<li><p><code>smallGroups</code>: data.table containing groups for which the number of
observation falls below <code>size.limit</code>.</p></li>
<li><p><code>cvHigh</code>: data.table containing a boolean variable which indicates for each
estimate if the estimated standard error exceeds <code>cv.limit</code>.</p></li>
<li><p><code>stEDecrease</code>: data.table indicating for each estimate the theoretical
increase in sample size which is gained when averaging over k periods. Only
returned if <code>period.mean</code> is not <code>NULL</code>.</p></li>
</ul>

    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>calc.stError</code> takes survey data (<code>dat</code>) and returns point estimates
as well as their standard Errors defined by <code>fun</code> and <code>var</code> for each sample
period in <code>dat</code>. <code>dat</code> must be household data where household members
correspond to multiple rows with the same household identifier. The data
should at least contain the following columns:</p><ul>
<li><p>Column indicating the sample period;</p></li>
<li><p>Column indicating the household ID;</p></li>
<li><p>Column containing the household sample weights;</p></li>
<li><p>Columns which contain the bootstrap weights (see output of <a href='recalib.html'>recalib</a>);</p></li>
<li><p>Columns listed in <code>var</code> as well as in <code>group</code></p></li>
</ul>
    <p>For each variable in <code>var</code> as well as sample period the function <code>fun</code> is
applied using the original as well as the bootstrap sample weights.<br />
The point estimate is then selected as the result of <code>fun</code> when using the
original sample weights and it's standard error is estimated with the result
of <code>fun</code> using the bootstrap sample weights. <br />
<br />
<code>fun</code> can be any function which returns a double or integer and uses sample
weights as it's second argument. The predifined options are <code>weightedRatio</code>
and <code>weightedSum</code>.<br />
<br />
For the option <code>weightedRatio</code> a weighted ratio (in %) of <code>var</code> is
calculated for <code>var</code> equal to 1, e.g
<code>sum(weight[var==1])/sum(weight[!is.na(var)])*100</code>.<br />
Additionally using the option <code>national=TRUE</code> the weighted ratio (in %) is
divided by the weighted ratio at the national level for each <code>period</code>.
<br />
If <code>group</code> is not <code>NULL</code> but a vector of variables from <code>dat</code> then <code>fun</code> is
applied on each subset of <code>dat</code> defined by all combinations of values in
<code>group</code>.<br />
For instance if <code>group = "sex"</code> with "sex" having the values "Male" and
"Female" in <code>dat</code> the point estimate and standard error is calculated on the
subsets of <code>dat</code> with only "Male" or "Female" value for "sex". This is done
for each value of <code>period</code>. For variables in <code>group</code> which have <code>NA</code>s in
<code>dat</code> the rows containing the missings will be discarded. <br />
When <code>group</code> is a list of character vectors, subsets of <code>dat</code> and the
following estimation of the point estimate, including the estimate for the
standard error, are calculated for each list entry.<br />
<br />
The optional parameters <code>fun.adjust.var</code> and <code>adjust.var</code> can be used if the
values in <code>var</code> are dependent on the <code>weights</code>. As is for instance the case
for the poverty thershhold calculated from EU-SILC.
In such a case an additional function can be supplied using <code>fun.adjust.var</code>
as well as its first argument <code>adjust.var</code>, which needs to be part of the
data set <code>dat</code>. Then, before applying <code>fun</code> on variable <code>var</code>
for all <code>period</code> and groups, the function <code>fun.adjust.var</code> is applied to
<code>adjust.var</code> using each of the bootstrap weights seperately (NOTE: weight is
used as the second argument of <code>fun.adjust.var</code>).
Thus creating i=1,...,<code><a href='https://rdrr.io/r/base/length.html'>length(b.weights)</a></code> additional variables.
For applying <code>fun</code> on <code>var</code> the estimates for the bootstrap replicate will
now use each of the corresponding new additional variables. So instead of
$$fun(var,weights,...),fun(var,b.weights[1],...),fun(var,b.weights[2],...),...$$
the function <code>fun</code> will be applied in the way
$$fun(var,weights,...),fun(var.1,b.weights[1],...),fun(var.2,b.weights[2],...),...$$</p>
<p>where <code>var.1</code>, <code>var.2</code>, <code>...</code> correspond to the estimates resulting from
<code>fun.adjust.var</code> and <code>adjust.var</code>.
NOTE: This procedure is especially usefull if the <code>var</code> is dependent on
<code>weights</code> and <code>fun</code> is applied on subgroups of the data set. Then it is not
possible to capture this procedure with <code>fun</code> and <code>var</code>, see examples for a
more hands on explanation.
<br />
When defining <code>period.diff</code> the difference of point estimates between periods
as well their standard errors are calculated.<br />
The entries in <code>period.diff</code> must have the form of <code>"period1 - period2"</code>
which means that the results of the point estimates for <code>period2</code> will be
substracted from the results of the point estimates for <code>period1</code>.<br />
<br />
Specifying <code>period.mean</code> leads to an improvement in standard error by
averaging the results for the point estimates, using the bootstrap weights,
over <code>period.mean</code> periods.
Setting, for instance, <code>period.mean = 3</code> the results in averaging these
results over each consecutive set of 3 periods.<br />
Estimating the standard error over these averages gives an improved estimate
of the standard error for the central period, which was used for
averaging.<br />
The averaging of the results is also applied in differences of point
estimates. For instance defining <code>period.diff = "2015-2009"</code> and
<code>period.mean = 3</code>
the differences in point estimates of 2015 and 2009, 2016 and 2010 as well as
2014 and 2008 are calcualated and finally the average over these 3
differences is calculated.
The periods set in <code>period.diff</code> are always used as the middle periods around
which the mean over <code>period.mean</code> years is build.
<br />
Setting <code>bias</code> to <code>TRUE</code> returns the calculation of a mean over the results
from the bootstrap replicates. In  the output the corresponding columns is
labeled <em>_mean</em> at the end.<br />
<br />
If <code>fun</code> needs more arguments they can be supplied in <code>add.arg</code>. This can
either be a named list or vector.<br />
<br />
The parameter <code>size.limit</code> indicates a lower bound of the sample size for
subsets in <code>dat</code> created by <code>group</code>. If the sample size of a subset falls
below <code>size.limit</code> a warning will be displayed.<br />
In addition all subsets for which this is the case can be selected from the
output of <code>calc.stError</code> with <code>$smallGroups</code>.<br />
With the parameter <code>cv.limit</code> one can set an upper bound on the coefficient
of variantion. Estimates which exceed this bound are flagged with <code>TRUE</code> and
are available in the function output with <code>$cvHigh</code>.
<code>cv.limit</code> must be a positive integer and is treated internally as %, e.g.
for <code>cv.limit=1</code> the estimate will be flagged if the coefficient of
variantion exceeds 1%.<br />
<br />
When specifying <code>period.mean</code>, the decrease in standard error for choosing
this method is internally calcualted and a rough estimate for an implied
increase in sample size is available in the output with <code>$stEDecrease</code>.
The rough estimate for the increase in sample size uses the fact that for a
sample of size \(n\) the sample estimate for the standard error of most
point estimates converges with a factor \(1/\sqrt{n}\) against the true
standard error \(\sigma\).</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><a href='draw.bootstrap.html'>draw.bootstrap</a> <br />
<a href='recalib.html'>recalib</a></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Import data and calibrate</span>

<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>1234</span>)
<span class='no'>eusilc</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='demo.eusilc.html'>demo.eusilc</a></span>(<span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>4</span>,<span class='kw'>prettyNames</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='no'>dat_boot</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='draw.bootstrap.html'>draw.bootstrap</a></span>(<span class='no'>eusilc</span>, <span class='kw'>REP</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>hid</span> <span class='kw'>=</span> <span class='st'>"hid"</span>, <span class='kw'>weights</span> <span class='kw'>=</span> <span class='st'>"pWeight"</span>,
                           <span class='kw'>strata</span> <span class='kw'>=</span> <span class='st'>"region"</span>, <span class='kw'>period</span> <span class='kw'>=</span> <span class='st'>"year"</span>)
<span class='no'>dat_boot_calib</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='recalib.html'>recalib</a></span>(<span class='no'>dat_boot</span>, <span class='kw'>conP.var</span> <span class='kw'>=</span> <span class='st'>"gender"</span>, <span class='kw'>conH.var</span> <span class='kw'>=</span> <span class='st'>"region"</span>)</div><div class='output co'>#&gt; <span class='message'>Convergence reached in 3 steps </span></div><div class='output co'>#&gt; <span class='message'>Convergence reached in 3 steps </span></div><div class='output co'>#&gt; <span class='message'>Convergence reached in 3 steps </span></div><div class='input'>
<span class='co'># estimate weightedRatio for povertyRisk per period</span>

<span class='no'>err.est</span> <span class='kw'>&lt;-</span> <span class='fu'>calc.stError</span>(<span class='no'>dat_boot_calib</span>, <span class='kw'>var</span> <span class='kw'>=</span> <span class='st'>"povertyRisk"</span>,
                        <span class='kw'>fun</span> <span class='kw'>=</span> <span class='no'>weightedRatio</span>)
<span class='no'>err.est</span>$<span class='no'>Estimates</span></div><div class='output co'>#&gt;    year     n       N val_povertyRisk stE_povertyRisk
#&gt; 1: 2010 14827 8182222        14.44422       0.9799161
#&gt; 2: 2011 14827 8182222        14.77393       1.0353349
#&gt; 3: 2012 14827 8182222        15.04515       1.0700378
#&gt; 4: 2013 14827 8182222        14.89013       1.0040285</div><div class='input'>
<span class='co'># calculate weightedRatio for povertyRisk and fraction of one-person</span>
<span class='co'># households per period</span>

<span class='no'>dat_boot_calib</span>[, <span class='no'>onePerson</span> <span class='kw'>:=</span> <span class='no'>.N</span> <span class='kw'>==</span> <span class='fl'>1</span>, <span class='kw'>by</span> <span class='kw'>=</span> <span class='fu'>.</span>(<span class='no'>year</span>, <span class='no'>hid</span>)]</div><div class='output co'>#&gt;          hid hsize        region     pid       age gender   ecoStat citizenship
#&gt;     1:     1 (2,3]         Tyrol     101   (25,45] female part time          AT
#&gt;     2:     1 (2,3]         Tyrol     102   (25,45]   male full time       Other
#&gt;     3:     1 (2,3]         Tyrol     103 (-Inf,16]   male      &lt;NA&gt;        &lt;NA&gt;
#&gt;     4:     1 (2,3]         Tyrol     101   (25,45] female part time          AT
#&gt;     5:     1 (2,3]         Tyrol     102   (25,45]   male full time       Other
#&gt;    ---                                                                         
#&gt; 59304: 10499 (3,4] Lower Austria 1049901   (45,65]   male full time          AT
#&gt; 59305: 10499 (3,4] Lower Austria 1049902   (45,65] female  domestic          AT
#&gt; 59306: 10499 (3,4] Lower Austria 1049903   (25,45]   male full time          AT
#&gt; 59307: 10499 (3,4] Lower Austria 1049904   (16,25] female  domestic          AT
#&gt; 59308: 10500 (0,1] Upper Austria 1050001   (25,45] female full time          AT
#&gt;          py010n py050n  py090n py100n py110n py120n  py130n py140n hy040n
#&gt;     1:  9756.25      0    0.00      0      0      0    0.00      0 4273.9
#&gt;     2: 12471.60      0    0.00      0      0      0    0.00      0 4273.9
#&gt;     3:       NA     NA      NA     NA     NA     NA      NA     NA 4273.9
#&gt;     4:  9756.25      0    0.00      0      0      0    0.00      0 4273.9
#&gt;     5: 12471.60      0    0.00      0      0      0    0.00      0 4273.9
#&gt;    ---                                                                   
#&gt; 59304: 22534.03      0    0.00      0      0      0 3023.79      0    0.0
#&gt; 59305:     0.00      0    0.00      0      0      0    0.00      0    0.0
#&gt; 59306:     0.00      0 5848.37      0      0      0    0.00      0    0.0
#&gt; 59307:     0.00      0 3737.27      0      0      0    0.00      0    0.0
#&gt; 59308: 13962.56      0    0.00      0      0      0    0.00      0    0.0
#&gt;         hy050n hy070n hy080n hy090n hy110n hy130n hy145n eqSS  eqIncome
#&gt;     1: 2428.11      0      0  33.39      0      0      0  1.8 16090.694
#&gt;     2: 2428.11      0      0  33.39      0      0      0  1.8 16090.694
#&gt;     3: 2428.11      0      0  33.39      0      0      0  1.8 16090.694
#&gt;     4: 2428.11      0      0  33.39      0      0      0  1.8 16090.694
#&gt;     5: 2428.11      0      0  33.39      0      0      0  1.8 16090.694
#&gt;    ---                                                                 
#&gt; 59304:    0.00      0      0 361.35      0      0      0  2.5 20360.440
#&gt; 59305:    0.00      0      0 361.35      0      0      0  2.5 20360.440
#&gt; 59306:    0.00      0      0 361.35      0      0      0  2.5 20360.440
#&gt; 59307:    0.00      0      0 361.35      0      0      0  2.5 20360.440
#&gt; 59308:    0.00      0      0 424.85      0      0      0  1.0  6923.625
#&gt;           db090  pWeight year povertyRisk          w1         w2       w3
#&gt;     1: 504.5696 504.5696 2010       FALSE 1004.403611 989.050091 1.448606
#&gt;     2: 504.5696 504.5696 2010       FALSE 1004.403611 989.050091 1.448606
#&gt;     3: 504.5696 504.5696 2010       FALSE 1004.403611 989.050091 1.448606
#&gt;     4: 504.5696 504.5696 2011       FALSE 1031.829705 954.938499 1.415007
#&gt;     5: 504.5696 504.5696 2011       FALSE 1031.829705 954.938499 1.415007
#&gt;    ---                                                                   
#&gt; 59304: 556.4260 556.4260 2013       FALSE    1.511241   1.523108 1.462957
#&gt; 59305: 556.4260 556.4260 2013       FALSE    1.511241   1.523108 1.462957
#&gt; 59306: 556.4260 556.4260 2013       FALSE    1.511241   1.523108 1.462957
#&gt; 59307: 556.4260 556.4260 2013       FALSE    1.511241   1.523108 1.462957
#&gt; 59308: 643.2557 643.2557 2013        TRUE 1258.598248   1.218966 1.194236
#&gt;        onePerson
#&gt;     1:     FALSE
#&gt;     2:     FALSE
#&gt;     3:     FALSE
#&gt;     4:     FALSE
#&gt;     5:     FALSE
#&gt;    ---          
#&gt; 59304:     FALSE
#&gt; 59305:     FALSE
#&gt; 59306:     FALSE
#&gt; 59307:     FALSE
#&gt; 59308:      TRUE</div><div class='input'><span class='no'>err.est</span> <span class='kw'>&lt;-</span> <span class='fu'>calc.stError</span>(<span class='no'>dat_boot_calib</span>, <span class='kw'>var</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"povertyRisk"</span>, <span class='st'>"onePerson"</span>),
                        <span class='kw'>fun</span> <span class='kw'>=</span> <span class='no'>weightedRatio</span>)
<span class='no'>err.est</span>$<span class='no'>Estimates</span></div><div class='output co'>#&gt;    year     n       N val_povertyRisk stE_povertyRisk val_onePerson
#&gt; 1: 2010 14827 8182222        14.44422       0.9799161      14.85737
#&gt; 2: 2011 14827 8182222        14.77393       1.0353349      14.85737
#&gt; 3: 2012 14827 8182222        15.04515       1.0700378      14.85737
#&gt; 4: 2013 14827 8182222        14.89013       1.0040285      14.85737
#&gt;    stE_onePerson
#&gt; 1:    0.40534856
#&gt; 2:    0.27338501
#&gt; 3:    0.25794383
#&gt; 4:    0.01449241</div><div class='input'>
<span class='co'># estimate weightedRatio for povertyRisk per period and gender</span>

<span class='no'>group</span> <span class='kw'>&lt;-</span> <span class='st'>"gender"</span>
<span class='no'>err.est</span> <span class='kw'>&lt;-</span> <span class='fu'>calc.stError</span>(<span class='no'>dat_boot_calib</span>, <span class='kw'>var</span> <span class='kw'>=</span> <span class='st'>"povertyRisk"</span>,
                        <span class='kw'>fun</span> <span class='kw'>=</span> <span class='no'>weightedRatio</span>, <span class='kw'>group</span> <span class='kw'>=</span> <span class='no'>group</span>)
<span class='no'>err.est</span>$<span class='no'>Estimates</span></div><div class='output co'>#&gt;     year     n       N gender val_povertyRisk stE_povertyRisk
#&gt;  1: 2010  7267 3979572   male        12.02660       1.3001159
#&gt;  2: 2010  7560 4202650 female        16.73351       0.7146193
#&gt;  3: 2010 14827 8182222   &lt;NA&gt;        14.44422       0.9799161
#&gt;  4: 2011  7267 3979572   male        12.81921       1.1794788
#&gt;  5: 2011  7560 4202650 female        16.62488       0.8983489
#&gt;  6: 2011 14827 8182222   &lt;NA&gt;        14.77393       1.0353349
#&gt;  7: 2012  7267 3979572   male        13.76065       1.3711175
#&gt;  8: 2012  7560 4202650 female        16.26147       0.7840769
#&gt;  9: 2012 14827 8182222   &lt;NA&gt;        15.04515       1.0700378
#&gt; 10: 2013  7267 3979572   male        13.88962       1.1465064
#&gt; 11: 2013  7560 4202650 female        15.83754       0.8746770
#&gt; 12: 2013 14827 8182222   &lt;NA&gt;        14.89013       1.0040285</div><div class='input'>
<span class='co'># estimate weightedRatio for povertyRisk per period and gender, region and</span>
<span class='co'># combination of both</span>

<span class='no'>group</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='st'>"gender"</span>, <span class='st'>"region"</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"gender"</span>, <span class='st'>"region"</span>))
<span class='no'>err.est</span> <span class='kw'>&lt;-</span> <span class='fu'>calc.stError</span>(<span class='no'>dat_boot_calib</span>, <span class='kw'>var</span> <span class='kw'>=</span> <span class='st'>"povertyRisk"</span>,
                        <span class='kw'>fun</span> <span class='kw'>=</span> <span class='no'>weightedRatio</span>, <span class='kw'>group</span> <span class='kw'>=</span> <span class='no'>group</span>)
<span class='no'>err.est</span>$<span class='no'>Estimates</span></div><div class='output co'>#&gt;      year     n         N gender        region val_povertyRisk stE_povertyRisk
#&gt;   1: 2010   261  122741.8   male    Burgenland       17.414524       1.8403555
#&gt;   2: 2010   288  137822.2 female    Burgenland       21.432598       1.5081260
#&gt;   3: 2010   359  182732.9   male    Vorarlberg       12.973259       3.2649724
#&gt;   4: 2010   374  194622.1 female    Vorarlberg       19.883637       3.2806993
#&gt;   5: 2010   440  253143.7   male      Salzburg        9.156964       2.0805572
#&gt;  ---                                                                          
#&gt; 116: 2013  2804 1555709.0   &lt;NA&gt; Lower Austria       14.340485       0.2211517
#&gt; 117: 2013  2805 1421620.0   &lt;NA&gt; Upper Austria       14.400780       1.5586570
#&gt; 118: 2013  7267 3979571.7   male          &lt;NA&gt;       13.889623       1.1465064
#&gt; 119: 2013  7560 4202650.3 female          &lt;NA&gt;       15.837536       0.8746770
#&gt; 120: 2013 14827 8182222.0   &lt;NA&gt;          &lt;NA&gt;       14.890134       1.0040285</div><div class='input'>
<span class='co'># use average over 3 periods for standard error estimation</span>

<span class='no'>err.est</span> <span class='kw'>&lt;-</span> <span class='fu'>calc.stError</span>(<span class='no'>dat_boot_calib</span>, <span class='kw'>var</span> <span class='kw'>=</span> <span class='st'>"povertyRisk"</span>,
                        <span class='kw'>fun</span> <span class='kw'>=</span> <span class='no'>weightedRatio</span>, <span class='kw'>period.mean</span> <span class='kw'>=</span> <span class='fl'>3</span>)
<span class='no'>err.est</span>$<span class='no'>Estimates</span></div><div class='output co'>#&gt;              year     n       N val_povertyRisk stE_povertyRisk
#&gt; 1:           2010 14827 8182222        14.44422       0.9799161
#&gt; 2: 2010_2011_2012 14827 8182222        14.75443       1.0136853
#&gt; 3:           2011 14827 8182222        14.77393       1.0353349
#&gt; 4: 2011_2012_2013 14827 8182222        14.90307       1.0223884
#&gt; 5:           2012 14827 8182222        15.04515       1.0700378
#&gt; 6:           2013 14827 8182222        14.89013       1.0040285</div><div class='input'>
<span class='co'># get estimate for difference of period 2011 and 2012</span>

<span class='no'>period.diff</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"2012-2011"</span>)
<span class='no'>err.est</span> <span class='kw'>&lt;-</span> <span class='fu'>calc.stError</span>(
  <span class='no'>dat_boot_calib</span>, <span class='kw'>var</span> <span class='kw'>=</span> <span class='st'>"povertyRisk"</span>, <span class='kw'>fun</span> <span class='kw'>=</span> <span class='no'>weightedRatio</span>,
  <span class='kw'>period.diff</span> <span class='kw'>=</span> <span class='no'>period.diff</span>, <span class='kw'>period.mean</span> <span class='kw'>=</span> <span class='fl'>3</span>)
<span class='no'>err.est</span>$<span class='no'>Estimates</span></div><div class='output co'>#&gt;              year     n       N val_povertyRisk stE_povertyRisk
#&gt; 1:           2010 14827 8182222      14.4442182     0.979916126
#&gt; 2: 2010_2011_2012 14827 8182222      14.7544308     1.013685324
#&gt; 3:           2011 14827 8182222      14.7739255     1.035334876
#&gt; 4: 2011_2012_2013 14827 8182222      14.9030692     1.022388390
#&gt; 5:           2012 14827 8182222      15.0451487     1.070037835
#&gt; 6:      2012-2011 14827 8182222       0.2712233     0.340045474
#&gt; 7: 2012-2011_mean 14827 8182222       0.1486385     0.009532779
#&gt; 8:           2013 14827 8182222      14.8901335     1.004028533</div><div class='input'>
<span class='co'># use add.arg-argument</span>
<span class='no'>fun</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>x</span>,<span class='no'>w</span>,<span class='no'>b</span>){
  <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span>(<span class='no'>x</span>*<span class='no'>w</span>*<span class='no'>b</span>)
}
<span class='no'>add.arg</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>b</span><span class='kw'>=</span><span class='st'>"onePerson"</span>)

<span class='no'>err.est</span> <span class='kw'>&lt;-</span> <span class='fu'>calc.stError</span>(<span class='no'>dat_boot_calib</span>, <span class='kw'>var</span> <span class='kw'>=</span> <span class='st'>"povertyRisk"</span>, <span class='kw'>fun</span> <span class='kw'>=</span> <span class='no'>fun</span>,
                        <span class='kw'>period.mean</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>add.arg</span><span class='kw'>=</span><span class='no'>add.arg</span>)
<span class='no'>err.est</span>$<span class='no'>Estimates</span></div><div class='output co'>#&gt;    year     n       N val_povertyRisk stE_povertyRisk
#&gt; 1: 2010 14827 8182222        273683.9        3328.502
#&gt; 2: 2011 14827 8182222        261883.6        5785.560
#&gt; 3: 2012 14827 8182222        243083.9        4143.528
#&gt; 4: 2013 14827 8182222        238004.4       13475.410</div><div class='input'><span class='co'># compare with direkt computation</span>
<span class='no'>compare.value</span> <span class='kw'>&lt;-</span> <span class='no'>dat_boot_calib</span>[,<span class='fu'>fun</span>(<span class='no'>povertyRisk</span>,<span class='no'>pWeight</span>,<span class='kw'>b</span><span class='kw'>=</span><span class='no'>onePerson</span>),
                                 <span class='kw'>by</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"year"</span>)]
<span class='fu'><a href='https://rdrr.io/r/base/all.html'>all</a></span>((<span class='no'>compare.value</span>$<span class='no'>V1</span>-<span class='no'>err.est</span>$<span class='no'>Estimates</span>$<span class='no'>val_povertyRisk</span>)<span class='kw'>==</span><span class='fl'>0</span>)</div><div class='output co'>#&gt; [1] TRUE</div><div class='input'>
<span class='co'># use a function from an other package that has sampling weights as its</span>
<span class='co'># second argument</span>
<span class='co'># for example gini() from laeken</span>

<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>laeken</span>)

<span class='co'>## set up help function that returns only the gini index</span>
<span class='no'>help_gini</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>x</span>, <span class='no'>w</span>){
 <span class='fu'><a href='https://rdrr.io/r/base/function.html'>return</a></span>(<span class='fu'><a href='https://rdrr.io/pkg/laeken/man/gini.html'>gini</a></span>(<span class='no'>x</span>, <span class='no'>w</span>)$<span class='no'>value</span>)
}

<span class='co'>## make sure povertyRisk get coerced to a numeric in order to work with the</span>
<span class='co'>## external functions</span>
<span class='fu'><a href='https://rdrr.io/r/base/invisible.html'>invisible</a></span>(<span class='no'>dat_boot_calib</span>[, <span class='no'>povertyRisk</span> <span class='kw'>:=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span>(<span class='no'>povertyRisk</span>)])

<span class='no'>err.est</span> <span class='kw'>&lt;-</span> <span class='fu'>calc.stError</span>(
  <span class='no'>dat_boot_calib</span>, <span class='kw'>var</span> <span class='kw'>=</span> <span class='st'>"povertyRisk"</span>, <span class='kw'>fun</span> <span class='kw'>=</span> <span class='no'>help_gini</span>, <span class='kw'>group</span> <span class='kw'>=</span> <span class='no'>group</span>,
  <span class='kw'>period.diff</span> <span class='kw'>=</span> <span class='no'>period.diff</span>, <span class='kw'>period.mean</span> <span class='kw'>=</span> <span class='fl'>3</span>)
<span class='no'>err.est</span>$<span class='no'>Estimates</span></div><div class='output co'>#&gt;      year     n         N gender        region val_povertyRisk stE_povertyRisk
#&gt;   1: 2010   261  122741.8   male    Burgenland        82.58548       1.8403555
#&gt;   2: 2010   288  137822.2 female    Burgenland        78.56740       1.5081260
#&gt;   3: 2010   359  182732.9   male    Vorarlberg        87.02674       3.2649724
#&gt;   4: 2010   374  194622.1 female    Vorarlberg        80.11636       3.2806993
#&gt;   5: 2010   440  253143.7   male      Salzburg        90.84304       2.0805572
#&gt;  ---                                                                          
#&gt; 236: 2013  2804 1555709.0   &lt;NA&gt; Lower Austria        85.65952       0.2211517
#&gt; 237: 2013  2805 1421620.0   &lt;NA&gt; Upper Austria        85.59922       1.5586570
#&gt; 238: 2013  7267 3979571.7   male          &lt;NA&gt;        86.11038       1.1465064
#&gt; 239: 2013  7560 4202650.3 female          &lt;NA&gt;        84.16246       0.8746770
#&gt; 240: 2013 14827 8182222.0   &lt;NA&gt;          &lt;NA&gt;        85.10987       1.0040285</div><div class='input'>
<span class='co'># using fun.adjust.var and adjust.var to estimate povmd60 indicator</span>
<span class='co'># for each period and bootstrap weight before applying the weightedRatio</span>
<span class='co'># point estimate</span>

<span class='co'># this function estimates the povmd60 indicator with x as income vector</span>
<span class='co'># and w as weight vector</span>
<span class='no'>povmd</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>x</span>, <span class='no'>w</span>){
 <span class='no'>md</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>laeken</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/laeken/man/weightedMedian.html'>weightedMedian</a></span>(<span class='no'>x</span>, <span class='no'>w</span>)*<span class='fl'>0.6</span>
 <span class='no'>pmd60</span> <span class='kw'>&lt;-</span> <span class='no'>x</span> <span class='kw'>&lt;</span> <span class='no'>md</span>
 <span class='fu'><a href='https://rdrr.io/r/base/function.html'>return</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/integer.html'>as.integer</a></span>(<span class='no'>pmd60</span>))
}

<span class='co'># set adjust.var="eqIncome" so the income vector ist used to estimate</span>
<span class='co'># the povmd60 indicator for each bootstrap weight</span>
<span class='co'># and the resultung indicators are passed to function weightedRatio</span>

<span class='no'>err.est</span> <span class='kw'>&lt;-</span> <span class='fu'>calc.stError</span>(
  <span class='no'>dat_boot_calib</span>, <span class='kw'>var</span> <span class='kw'>=</span> <span class='st'>"povertyRisk"</span>, <span class='kw'>fun</span> <span class='kw'>=</span> <span class='no'>weightedRatio</span>, <span class='kw'>group</span> <span class='kw'>=</span> <span class='no'>group</span>,
  <span class='kw'>fun.adjust.var</span> <span class='kw'>=</span> <span class='no'>povmd</span>, <span class='kw'>adjust.var</span> <span class='kw'>=</span> <span class='st'>"eqIncome"</span>, <span class='kw'>period.mean</span> <span class='kw'>=</span> <span class='fl'>3</span>)
<span class='no'>err.est</span>$<span class='no'>Estimates</span></div><div class='output co'>#&gt;      year     n         N gender        region val_povertyRisk stE_povertyRisk
#&gt;   1: 2010   261  122741.8   male    Burgenland       17.414524       1.8403555
#&gt;   2: 2010   288  137822.2 female    Burgenland       21.432598       1.5511880
#&gt;   3: 2010   359  182732.9   male    Vorarlberg       12.973259       3.2649724
#&gt;   4: 2010   374  194622.1 female    Vorarlberg       19.883637       3.2806993
#&gt;   5: 2010   440  253143.7   male      Salzburg        9.156964       2.0805572
#&gt;  ---                                                                          
#&gt; 176: 2013  2804 1555709.0   &lt;NA&gt; Lower Austria       14.340485       0.6043924
#&gt; 177: 2013  2805 1421620.0   &lt;NA&gt; Upper Austria       14.400780       0.8548661
#&gt; 178: 2013  7267 3979571.7   male          &lt;NA&gt;       13.889623       1.0267547
#&gt; 179: 2013  7560 4202650.3 female          &lt;NA&gt;       15.837536       0.7767773
#&gt; 180: 2013 14827 8182222.0   &lt;NA&gt;          &lt;NA&gt;       14.890134       0.8940319</div><div class='input'>
<span class='co'># why fun.adjust.var and adjust.var are needed (!!!):</span>
<span class='co'># one could also use the following function</span>
<span class='co'># and set fun.adjust.var=NULL,adjust.var=NULL</span>
<span class='co'># and set fun = povmd, var = "eqIncome"</span>

<span class='no'>povmd2</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>x</span>, <span class='no'>w</span>){
 <span class='no'>md</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>laeken</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/laeken/man/weightedMedian.html'>weightedMedian</a></span>(<span class='no'>x</span>, <span class='no'>w</span>)*<span class='fl'>0.6</span>
 <span class='no'>pmd60</span> <span class='kw'>&lt;-</span> <span class='no'>x</span> <span class='kw'>&lt;</span> <span class='no'>md</span>
 <span class='co'># weighted ratio is directly estimated inside my function</span>
 <span class='fu'><a href='https://rdrr.io/r/base/function.html'>return</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span>(<span class='no'>w</span>[<span class='no'>pmd60</span>])/<span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span>(<span class='no'>w</span>)*<span class='fl'>100</span>)
}

<span class='co'># but this results in different results in subgroups</span>
<span class='co'># compared to using fun.adjust.var and adjust.var</span>

<span class='no'>err.est.different</span> <span class='kw'>&lt;-</span> <span class='fu'>calc.stError</span>(
  <span class='no'>dat_boot_calib</span>, <span class='kw'>var</span> <span class='kw'>=</span> <span class='st'>"eqIncome"</span>, <span class='kw'>fun</span> <span class='kw'>=</span> <span class='no'>povmd2</span>, <span class='kw'>group</span> <span class='kw'>=</span> <span class='no'>group</span>,
  <span class='kw'>fun.adjust.var</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>adjust.var</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>period.mean</span> <span class='kw'>=</span> <span class='fl'>3</span>)
<span class='no'>err.est.different</span>$<span class='no'>Estimates</span></div><div class='output co'>#&gt;      year     n         N gender        region val_eqIncome stE_eqIncome
#&gt;   1: 2010   261  122741.8   male    Burgenland     18.61871    1.9807542
#&gt;   2: 2010   288  137822.2 female    Burgenland     18.12804    3.4120830
#&gt;   3: 2010   359  182732.9   male    Vorarlberg     14.10553    3.1630747
#&gt;   4: 2010   374  194622.1 female    Vorarlberg     19.34374    4.6711041
#&gt;   5: 2010   440  253143.7   male      Salzburg     11.71768    3.2427620
#&gt;  ---                                                                    
#&gt; 176: 2013  2804 1555709.0   &lt;NA&gt; Lower Austria     14.82065    0.5491969
#&gt; 177: 2013  2805 1421620.0   &lt;NA&gt; Upper Austria     14.51550    0.5535925
#&gt; 178: 2013  7267 3979571.7   male          &lt;NA&gt;     15.23198    0.9049968
#&gt; 179: 2013  7560 4202650.3 female          &lt;NA&gt;     14.88139    1.1356756
#&gt; 180: 2013 14827 8182222.0   &lt;NA&gt;          &lt;NA&gt;     14.89013    0.8940319</div><div class='input'>
<span class='co'>## results are equal for yearly estimates</span>
<span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span>(<span class='no'>err.est.different</span>$<span class='no'>Estimates</span>[<span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span>(<span class='no'>gender</span>) <span class='kw'>&amp;</span> <span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span>(<span class='no'>region</span>)],
          <span class='no'>err.est</span>$<span class='no'>Estimates</span>[<span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span>(<span class='no'>gender</span>)<span class='kw'>&amp;</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span>(<span class='no'>region</span>)],
          <span class='kw'>check.attributes</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='output co'>#&gt; [1] TRUE</div><div class='input'>
<span class='co'>## but for subgroups (gender, region) results vary</span>
<span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span>(<span class='no'>err.est.different</span>$<span class='no'>Estimates</span>[!(<span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span>(<span class='no'>gender</span>) <span class='kw'>&amp;</span> <span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span>(<span class='no'>region</span>))],
          <span class='no'>err.est</span>$<span class='no'>Estimates</span>[!(<span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span>(<span class='no'>gender</span>) <span class='kw'>&amp;</span> <span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span>(<span class='no'>region</span>))],
          <span class='kw'>check.attributes</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='output co'>#&gt; [1] "Column 'val_eqIncome': Mean relative difference: 0.08000699"</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Johannes Gussenbauer, Alexander Kowarik, Statistics Austria</p>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Johannes Gussenbauer, Alexander Kowarik, Gregor de Cillia.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.9100.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

